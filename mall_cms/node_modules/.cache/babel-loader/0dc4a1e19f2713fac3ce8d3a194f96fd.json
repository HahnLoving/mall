{"ast":null,"code":"import { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withModifiers as _withModifiers, withCtx as _withCtx, createVNode as _createVNode, toDisplayString as _toDisplayString, resolveDirective as _resolveDirective, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\n\nvar _withScopeId = function _withScopeId(n) {\n  return _pushScopeId(\"data-v-3ff3183c\"), n = n(), _popScopeId(), n;\n};\n\nvar _hoisted_1 = {\n  key: 0,\n  class: \"container\"\n};\nvar _hoisted_2 = {\n  class: \"header\"\n};\n\nvar _hoisted_3 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"div\", {\n    class: \"title\"\n  }, \"优惠卷模板列表\", -1\n  /* HOISTED */\n  );\n});\n\nvar _hoisted_4 = /*#__PURE__*/_createTextVNode(\"新增优惠券模板\");\n\nvar _hoisted_5 = {\n  \"slot-scope\": \"scope\"\n};\nvar _hoisted_6 = {\n  \"slot-scope\": \"scope\"\n};\n\nvar _hoisted_7 = /*#__PURE__*/_createTextVNode(\"编辑\");\n\nvar _hoisted_8 = /*#__PURE__*/_createTextVNode(\"删除\");\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_el_button = _resolveComponent(\"el-button\");\n\n  var _component_el_table_column = _resolveComponent(\"el-table-column\");\n\n  var _component_el_table = _resolveComponent(\"el-table\");\n\n  var _component_coupon_template_edit = _resolveComponent(\"coupon-template-edit\");\n\n  var _directive_permission = _resolveDirective(\"permission\");\n\n  var _directive_loading = _resolveDirective(\"loading\");\n\n  return _openBlock(), _createElementBlock(\"div\", null, [!$data.showEdit ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_hoisted_3, _createVNode(_component_el_button, {\n    style: {\n      \"margin-left\": \"30px\"\n    },\n    onClick: _withModifiers($options.addCouponTemplate, [\"prevent\"]),\n    type: \"primary\",\n    plain: \"\",\n    size: \"medium\"\n  }, {\n    default: _withCtx(function () {\n      return [_hoisted_4];\n    }),\n    _: 1\n    /* STABLE */\n\n  }, 8\n  /* PROPS */\n  , [\"onClick\"])]), _withDirectives(_createVNode(_component_el_table, {\n    stripe: \"\",\n    data: $data.templates\n  }, {\n    default: _withCtx(function () {\n      return [_createVNode(_component_el_table_column, {\n        prop: \"id\",\n        label: \"id\",\n        width: \"100\"\n      }), _createVNode(_component_el_table_column, {\n        prop: \"title\",\n        label: \"名称\",\n        width: \"250\"\n      }), _createVNode(_component_el_table_column, {\n        prop: \"full_money\",\n        label: \"满减额\",\n        width: \"150\"\n      }), _createVNode(_component_el_table_column, {\n        prop: \"minus\",\n        label: \"优惠额\",\n        width: \"150\"\n      }), _createVNode(_component_el_table_column, {\n        prop: \"discount\",\n        label: \"折扣\",\n        width: \"150\"\n      }), _createVNode(_component_el_table_column, {\n        prop: \"type\",\n        label: \"类型\",\n        width: \"150\"\n      }, {\n        default: _withCtx(function () {\n          return [_createElementVNode(\"template\", _hoisted_5, [_createTextVNode(_toDisplayString(_ctx.scope.row.type | _ctx.typeFormat), 1\n          /* TEXT */\n          )])];\n        }),\n        _: 1\n        /* STABLE */\n\n      }), _createVNode(_component_el_table_column, {\n        prop: \"description\",\n        label: \"描述\",\n        \"min-width\": \"300\"\n      }), _createVNode(_component_el_table_column, {\n        fixed: \"right\",\n        width: \"150\",\n        label: \"操作\"\n      }, {\n        default: _withCtx(function () {\n          return [_createElementVNode(\"template\", _hoisted_6, [_createVNode(_component_el_button, {\n            onClick: _cache[0] || (_cache[0] = _withModifiers(function ($event) {\n              return $options.handleEdit(_ctx.scope.row);\n            }, [\"prevent\"])),\n            type: \"primary\",\n            plain: \"\",\n            size: \"mini\"\n          }, {\n            default: _withCtx(function () {\n              return [_hoisted_7];\n            }),\n            _: 1\n            /* STABLE */\n\n          }), _withDirectives(_createVNode(_component_el_button, {\n            onClick: _cache[1] || (_cache[1] = _withModifiers(function ($event) {\n              return $options.handleDelete(_ctx.scope.row);\n            }, [\"prevent\"])),\n            type: \"danger\",\n            size: \"mini\",\n            plain: \"\"\n          }, {\n            default: _withCtx(function () {\n              return [_hoisted_8];\n            }),\n            _: 1\n            /* STABLE */\n\n          }, 512\n          /* NEED_PATCH */\n          ), [[_directive_permission, {\n            auth: ['删除优惠卷模板'],\n            type: 'disabled'\n          }]])])];\n        }),\n        _: 1\n        /* STABLE */\n\n      })];\n    }),\n    _: 1\n    /* STABLE */\n\n  }, 8\n  /* PROPS */\n  , [\"data\"]), [[_directive_loading, $data.loading]])])) : (_openBlock(), _createBlock(_component_coupon_template_edit, {\n    key: 1,\n    onEditClose: $options.editClose,\n    isCreate: $data.isCreate,\n    couponTemplateId: $data.couponId\n  }, null, 8\n  /* PROPS */\n  , [\"onEditClose\", \"isCreate\", \"couponTemplateId\"]))]);\n}","map":{"version":3,"sources":["/Users/zhahn/Documents/Hahn/自考/项目/mall_cms/src/view/coupon/coupon-template-list.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <div v-if=\"!showEdit\" class=\"container\">\n      <div class=\"header\">\n        <div class=\"title\">优惠卷模板列表</div>\n        <el-button style=\"margin-left:30px;\" @click.prevent=\"addCouponTemplate\" type=\"primary\" plain size=\"medium\"\n          >新增优惠券模板</el-button\n        >\n      </div>\n\n      <el-table stripe v-loading=\"loading\" :data=\"templates\">\n        <el-table-column prop=\"id\" label=\"id\" width=\"100\"></el-table-column>\n        <el-table-column prop=\"title\" label=\"名称\" width=\"250\"></el-table-column>\n        <el-table-column prop=\"full_money\" label=\"满减额\" width=\"150\"></el-table-column>\n        <el-table-column prop=\"minus\" label=\"优惠额\" width=\"150\"></el-table-column>\n        <el-table-column prop=\"discount\" label=\"折扣\" width=\"150\"></el-table-column>\n        <el-table-column prop=\"type\" label=\"类型\" width=\"150\">\n          <template slot-scope=\"scope\">{{ scope.row.type | typeFormat }}</template>\n        </el-table-column>\n        <el-table-column prop=\"description\" label=\"描述\" min-width=\"300\"></el-table-column>\n        <el-table-column fixed=\"right\" width=\"150\" label=\"操作\">\n          <template slot-scope=\"scope\">\n            <el-button @click.prevent=\"handleEdit(scope.row)\" type=\"primary\" plain size=\"mini\">编辑</el-button>\n            <el-button\n              v-permission=\"{ auth: ['删除优惠卷模板'], type: 'disabled' }\"\n              @click.prevent=\"handleDelete(scope.row)\"\n              type=\"danger\"\n              size=\"mini\"\n              plain\n              >删除</el-button\n            >\n          </template>\n        </el-table-column>\n      </el-table>\n    </div>\n    <coupon-template-edit\n      v-else\n      @editClose=\"editClose\"\n      :isCreate=\"isCreate\"\n      :couponTemplateId=\"couponId\"\n    ></coupon-template-edit>\n  </div>\n</template>\n\n<script>\nimport dayjs from 'dayjs'\nimport Coupon from '@/model/coupon'\nimport CouponTemplateEdit from './CouponTemplateEdit'\n\nexport default {\n  components: { CouponTemplateEdit },\n  props: {\n    activityId: {\n      type: String,\n      default: null,\n    },\n  },\n  data() {\n    return {\n      couponId: null,\n      isCreate: false,\n      tableData: [],\n      templates: [],\n      showEdit: false,\n      loading: false,\n    }\n  },\n  async created() {\n    this.$nextTick(() => {\n      this.loading = true\n      this.getTemplates()\n      this.loading = false\n    })\n  },\n  methods: {\n    async addCouponTemplate() {\n      this.isCreate = true\n      this.couponId = null\n      this.showEdit = true\n    },\n    async getTemplates() {\n      const templates = await Coupon.getCouponTemplates()\n      this.templates = templates\n    },\n    handleEdit(val) {\n      this.isCreate = false\n      this.couponId = val.id\n      this.showEdit = true\n    },\n    handleDelete(val) {\n      this.$confirm('此操作将永久删除该项, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning',\n      }).then(async () => {\n        const res = await Coupon.deleteCouponTemplate(val.id)\n        if (res.code < window.MAX_SUCCESS_CODE) {\n          this.$message({\n            type: 'success',\n            message: `${res.message}`,\n          })\n          this.loading = true\n          this.getTemplates()\n          this.loading = false\n        } else {\n          this.loading = false\n          this.$message.error(`${res.message}`)\n        }\n      })\n    },\n    editClose() {\n      this.showEdit = false\n      this.getTemplates()\n    },\n  },\n  filters: {\n    dateFormat(val) {\n      return dayjs(val).format('YYYY-MM-DD HH:mm:ss')\n    },\n    typeFormat(val) {\n      switch (val) {\n        case 1:\n          return '满减券'\n        case 2:\n          return '折扣券'\n        case 3:\n          return '无门槛券'\n        case 4:\n          return '满金额折扣券'\n        default:\n          return val\n      }\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.container {\n  padding: 0 30px;\n\n  .header {\n    display: flex;\n    align-items: center;\n\n    .title {\n      height: 59px;\n      line-height: 59px;\n      color: $parent-title-color;\n      font-size: 16px;\n      font-weight: 500;\n    }\n  }\n\n  .pagination {\n    display: flex;\n    justify-content: flex-end;\n    margin: 20px;\n  }\n}\n</style>\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}