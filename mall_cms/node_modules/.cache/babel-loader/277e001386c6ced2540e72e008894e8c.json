{"ast":null,"code":"import { toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, withModifiers as _withModifiers, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\n\nvar _withScopeId = function _withScopeId(n) {\n  return _pushScopeId(\"data-v-5f4778fe\"), n = n(), _popScopeId(), n;\n};\n\nvar _hoisted_1 = {\n  class: \"container\"\n};\nvar _hoisted_2 = {\n  key: 0,\n  class: \"title\"\n};\nvar _hoisted_3 = {\n  key: 1,\n  class: \"title\"\n};\n\nvar _hoisted_4 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"span\", null, \"修改图书\", -1\n  /* HOISTED */\n  );\n});\n\nvar _hoisted_5 = /*#__PURE__*/_createTextVNode();\n\nvar _hoisted_6 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"i\", {\n    class: \"iconfont icon-fanhui\"\n  }, null, -1\n  /* HOISTED */\n  );\n});\n\nvar _hoisted_7 = /*#__PURE__*/_createTextVNode(\" 返回 \");\n\nvar _hoisted_8 = [_hoisted_6, _hoisted_7];\nvar _hoisted_9 = {\n  class: \"wrap\"\n};\n\nvar _hoisted_10 = /*#__PURE__*/_createTextVNode(\"保 存\");\n\nvar _hoisted_11 = /*#__PURE__*/_createTextVNode(\"重 置\");\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_el_input = _resolveComponent(\"el-input\");\n\n  var _component_el_form_item = _resolveComponent(\"el-form-item\");\n\n  var _component_el_button = _resolveComponent(\"el-button\");\n\n  var _component_el_form = _resolveComponent(\"el-form\");\n\n  var _component_el_col = _resolveComponent(\"el-col\");\n\n  var _component_el_row = _resolveComponent(\"el-row\");\n\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [!$props.editBookId ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, \"新建图书\" + _toDisplayString($props.editBookId), 1\n  /* TEXT */\n  )) : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_hoisted_4, _hoisted_5, _createElementVNode(\"span\", {\n    class: \"back\",\n    onClick: _cache[0] || (_cache[0] = function () {\n      return $setup.back && $setup.back.apply($setup, arguments);\n    })\n  }, _hoisted_8)])), _createElementVNode(\"div\", _hoisted_9, [_createVNode(_component_el_row, null, {\n    default: _withCtx(function () {\n      return [_createVNode(_component_el_col, {\n        lg: 16,\n        md: 20,\n        sm: 24,\n        xs: 24\n      }, {\n        default: _withCtx(function () {\n          return [_createVNode(_component_el_form, {\n            model: $setup.book,\n            \"status-icon\": \"\",\n            ref: \"form\",\n            \"label-width\": \"100px\",\n            onSubmit: _cache[5] || (_cache[5] = _withModifiers(function () {}, [\"prevent\"])),\n            rules: $setup.rules\n          }, {\n            default: _withCtx(function () {\n              return [_createVNode(_component_el_form_item, {\n                label: \"书名\",\n                prop: \"title\"\n              }, {\n                default: _withCtx(function () {\n                  return [_createVNode(_component_el_input, {\n                    modelValue: $setup.book.title,\n                    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = function ($event) {\n                      return $setup.book.title = $event;\n                    }),\n                    placeholder: \"请填写书名\"\n                  }, null, 8\n                  /* PROPS */\n                  , [\"modelValue\"])];\n                }),\n                _: 1\n                /* STABLE */\n\n              }), _createVNode(_component_el_form_item, {\n                label: \"作者\",\n                prop: \"author\"\n              }, {\n                default: _withCtx(function () {\n                  return [_createVNode(_component_el_input, {\n                    modelValue: $setup.book.author,\n                    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = function ($event) {\n                      return $setup.book.author = $event;\n                    }),\n                    placeholder: \"请填写作者\"\n                  }, null, 8\n                  /* PROPS */\n                  , [\"modelValue\"])];\n                }),\n                _: 1\n                /* STABLE */\n\n              }), _createVNode(_component_el_form_item, {\n                label: \"封面\",\n                prop: \"image\"\n              }, {\n                default: _withCtx(function () {\n                  return [_createVNode(_component_el_input, {\n                    modelValue: $setup.book.image,\n                    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = function ($event) {\n                      return $setup.book.image = $event;\n                    }),\n                    placeholder: \"请填写封面地址\"\n                  }, null, 8\n                  /* PROPS */\n                  , [\"modelValue\"])];\n                }),\n                _: 1\n                /* STABLE */\n\n              }), _createVNode(_component_el_form_item, {\n                label: \"简介\",\n                prop: \"summary\"\n              }, {\n                default: _withCtx(function () {\n                  return [_createVNode(_component_el_input, {\n                    type: \"textarea\",\n                    autosize: {\n                      minRows: 4,\n                      maxRows: 8\n                    },\n                    placeholder: \"请输入简介\",\n                    modelValue: $setup.book.summary,\n                    \"onUpdate:modelValue\": _cache[4] || (_cache[4] = function ($event) {\n                      return $setup.book.summary = $event;\n                    })\n                  }, null, 8\n                  /* PROPS */\n                  , [\"modelValue\"])];\n                }),\n                _: 1\n                /* STABLE */\n\n              }), _createVNode(_component_el_form_item, {\n                class: \"submit\"\n              }, {\n                default: _withCtx(function () {\n                  return [_createVNode(_component_el_button, {\n                    type: \"primary\",\n                    onClick: $setup.submitForm\n                  }, {\n                    default: _withCtx(function () {\n                      return [_hoisted_10];\n                    }),\n                    _: 1\n                    /* STABLE */\n\n                  }, 8\n                  /* PROPS */\n                  , [\"onClick\"]), _createVNode(_component_el_button, {\n                    onClick: $setup.resetForm\n                  }, {\n                    default: _withCtx(function () {\n                      return [_hoisted_11];\n                    }),\n                    _: 1\n                    /* STABLE */\n\n                  }, 8\n                  /* PROPS */\n                  , [\"onClick\"])];\n                }),\n                _: 1\n                /* STABLE */\n\n              })];\n            }),\n            _: 1\n            /* STABLE */\n\n          }, 8\n          /* PROPS */\n          , [\"model\", \"rules\"])];\n        }),\n        _: 1\n        /* STABLE */\n\n      })];\n    }),\n    _: 1\n    /* STABLE */\n\n  })])]);\n}","map":{"version":3,"sources":["/Users/zhahn/Documents/Hahn/自考/mall/mall_cms/src/view/book/book.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"container\">\n    <div class=\"title\" v-if=\"!editBookId\">新建图书{{ editBookId }}</div>\n    <div class=\"title\" v-else>\n      <span>修改图书</span> <span class=\"back\" @click=\"back\"> <i class=\"iconfont icon-fanhui\"></i> 返回 </span>\n    </div>\n\n    <div class=\"wrap\">\n      <el-row>\n        <el-col :lg=\"16\" :md=\"20\" :sm=\"24\" :xs=\"24\">\n          <el-form :model=\"book\" status-icon ref=\"form\" label-width=\"100px\" @submit.prevent :rules=\"rules\">\n            <el-form-item label=\"书名\" prop=\"title\">\n              <el-input v-model=\"book.title\" placeholder=\"请填写书名\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"作者\" prop=\"author\">\n              <el-input v-model=\"book.author\" placeholder=\"请填写作者\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"封面\" prop=\"image\">\n              <el-input v-model=\"book.image\" placeholder=\"请填写封面地址\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"简介\" prop=\"summary\">\n              <el-input\n                type=\"textarea\"\n                :autosize=\"{ minRows: 4, maxRows: 8 }\"\n                placeholder=\"请输入简介\"\n                v-model=\"book.summary\"\n              >\n              </el-input>\n            </el-form-item>\n\n            <el-form-item class=\"submit\">\n              <el-button type=\"primary\" @click=\"submitForm\">保 存</el-button>\n              <el-button @click=\"resetForm\">重 置</el-button>\n            </el-form-item>\n          </el-form>\n        </el-col>\n      </el-row>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { reactive, ref, onMounted } from 'vue'\nimport { ElMessage } from 'element-plus'\nimport bookModel from '@/model/book'\n\nexport default {\n  props: {\n    editBookId: {\n      type: Number,\n      default: null,\n    },\n  },\n  setup(props, context) {\n    const form = ref(null)\n    const loading = ref(false)\n    const book = reactive({ title: '', author: '', summary: '', image: '' })\n\n    const listAssign = (a, b) => Object.keys(a).forEach(key => {\n      a[key] = b[key] || a[key]\n    })\n\n    /**\n     * 表单规则验证\n     */\n    const { rules } = getRules()\n\n    onMounted(() => {\n      if (props.editBookId) {\n        getBook()\n      }\n    })\n\n    const getBook = async () => {\n      loading.value = true\n      const res = await bookModel.getBook(props.editBookId)\n      listAssign(book, res)\n      loading.value = false\n    }\n\n    // 重置表单\n    const resetForm = () => {\n      form.value.resetFields()\n    }\n\n    const submitForm = async formName => {\n      form.value.validate(async valid => {\n        if (valid) {\n          let res = {}\n          if (props.editBookId) {\n            res = await bookModel.editBook(props.editBookId, book)\n            context.emit('editClose')\n          } else {\n            res = await bookModel.createBook(book)\n            resetForm(formName)\n          }\n          if (res.code < window.MAX_SUCCESS_CODE) {\n            ElMessage.success(`${res.message}`)\n          }\n        } else {\n          console.error('error submit!!')\n          ElMessage.error('请将信息填写完整')\n        }\n      })\n    }\n\n    const back = () => {\n      context.emit('editClose')\n    }\n\n    return {\n      back,\n      book,\n      form,\n      rules,\n      resetForm,\n      submitForm,\n    }\n  },\n}\n\n/**\n * 表单验证规则\n */\nfunction getRules() {\n  /**\n   * 验证回调函数\n   */\n  const checkInfo = (rule, value, callback) => {\n    if (!value) {\n      callback(new Error('信息不能为空'))\n    }\n    callback()\n  }\n  const rules = {\n    title: [{ validator: checkInfo, trigger: 'blur', required: true }],\n    author: [{ validator: checkInfo, trigger: 'blur', required: true }],\n    summary: [{ validator: checkInfo, trigger: 'blur', required: true }],\n    image: [{ validator: checkInfo, trigger: 'blur', required: true }],\n  }\n  return { rules }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.container {\n  .title {\n    height: 59px;\n    line-height: 59px;\n    color: $parent-title-color;\n    font-size: 16px;\n    font-weight: 500;\n    text-indent: 40px;\n    border-bottom: 1px solid #dae1ec;\n\n    .back {\n      float: right;\n      margin-right: 40px;\n      cursor: pointer;\n    }\n  }\n\n  .wrap {\n    padding: 20px;\n  }\n\n  .submit {\n    float: left;\n  }\n}\n</style>\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}