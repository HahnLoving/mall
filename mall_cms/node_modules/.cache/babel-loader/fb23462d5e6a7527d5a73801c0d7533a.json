{"ast":null,"code":"import _asyncToGenerator from \"/Users/zhahn/Documents/Hahn/\\u81EA\\u8003/mall/mall_cms/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"regenerator-runtime/runtime.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport Editor from '@tinymce/tinymce-vue';\nimport { post } from '@/lin/plugin/axios';\nexport default {\n  name: 'TinymceEditor',\n  props: {\n    defaultContent: {\n      type: String,\n      default: ''\n    },\n    height: {\n      type: Number,\n      default: 500\n    },\n    width: {\n      type: Number,\n      default: undefined\n    },\n    showMenubar: {\n      type: Boolean,\n      default: true\n    },\n    toolbar: {\n      type: String,\n      default: \" undo redo\\n      | formatselect\\n      | bold italic strikethrough forecolor backcolor formatpainter\\n      | link image | alignleft aligncenter alignright alignjustify\\n      | numlist bullist outdent indent\\n      | removeformat\\n      | preview fullscreen code\"\n    }\n  },\n  components: {\n    Editor: Editor\n  },\n  data: function data() {\n    return {\n      content: '',\n      tinymceFlag: 1,\n      tinymceInit: {}\n    };\n  },\n  created: function created() {\n    this.tinymceInit = {\n      language: 'zh_CN',\n      height: this.height,\n      branding: true,\n      // 去水印\n      statusbar: false,\n      // 隐藏编辑器底部的状态栏\n      elementpath: false,\n      // 禁用编辑器底部的状态栏\n      toolbar: this.toolbar,\n      paste_data_images: true,\n      // 允许粘贴图像\n      browser_spellcheck: true,\n      // 拼写检查\n      menubar: this.showMenubar,\n      // 隐藏最上方menu\n      plugins: \"print fullpage searchreplace autolink directionality visualblocks\\n        visualchars template codesample charmap hr pagebreak nonbreaking anchor toc insertdatetime\\n        wordcount textpattern help advlist table lists paste preview fullscreen image imagetools code link\",\n      images_upload_handler: function images_upload_handler(blobInfo, success, failure) {\n        return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n          var file;\n          return regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  file = new File([blobInfo.blob()], blobInfo.filename(), {\n                    type: 'image/*'\n                  });\n                  post('cms/file', {\n                    file: file\n                  }).then(function (res) {\n                    var _res$;\n\n                    if (res.length && (_res$ = res[0]) !== null && _res$ !== void 0 && _res$.url) {\n                      success(res[0].url);\n                    }\n                  }).catch(function (err) {\n                    return failure(err);\n                  });\n\n                case 2:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }))();\n      }\n    };\n  },\n  mounted: function mounted() {\n    if (this.defaultContent) {\n      this.content = this.defaultContent;\n    }\n  },\n  watch: {\n    content: {\n      handler: function handler() {\n        this.$emit('change', this.content);\n      }\n    },\n    defaultContent: {\n      handler: function handler() {\n        this.content = this.defaultContent;\n      },\n      immediate: true\n    }\n  },\n  activated: function activated() {\n    this.tinymceFlag++;\n  }\n};","map":{"version":3,"sources":["/Users/zhahn/Documents/Hahn/自考/mall/mall_cms/src/component/base/tinymce/index.vue"],"names":[],"mappings":";;;AAMA,OAAO,MAAP,MAAmB,sBAAnB;AACA,SAAS,IAAT,QAAqB,oBAArB;AAEA,eAAe;AACb,EAAA,IAAI,EAAE,eADO;AAEb,EAAA,KAAK,EAAE;AACL,IAAA,cAAc,EAAE;AACd,MAAA,IAAI,EAAE,MADQ;AAEd,MAAA,OAAO,EAAE;AAFK,KADX;AAKL,IAAA,MAAM,EAAE;AACN,MAAA,IAAI,EAAE,MADA;AAEN,MAAA,OAAO,EAAE;AAFH,KALH;AASL,IAAA,KAAK,EAAE;AACL,MAAA,IAAI,EAAE,MADD;AAEL,MAAA,OAAO,EAAE;AAFJ,KATF;AAaL,IAAA,WAAW,EAAE;AACX,MAAA,IAAI,EAAE,OADK;AAEX,MAAA,OAAO,EAAE;AAFE,KAbR;AAiBL,IAAA,OAAO,EAAE;AACP,MAAA,IAAI,EAAE,MADC;AAEP,MAAA,OAAO;AAFA;AAjBJ,GAFM;AA8Bb,EAAA,UAAU,EAAE;AACV,IAAA,MAAM,EAAN;AADU,GA9BC;AAiCb,EAAA,IAjCa,kBAiCN;AACL,WAAO;AACL,MAAA,OAAO,EAAE,EADJ;AAEL,MAAA,WAAW,EAAE,CAFR;AAGL,MAAA,WAAW,EAAE;AAHR,KAAP;AAKD,GAvCY;AAwCb,EAAA,OAxCa,qBAwCH;AACR,SAAK,WAAL,GAAmB;AACjB,MAAA,QAAQ,EAAE,OADO;AAEjB,MAAA,MAAM,EAAE,KAAK,MAFI;AAGjB,MAAA,QAAQ,EAAE,IAHO;AAGD;AAChB,MAAA,SAAS,EAAE,KAJM;AAIC;AAClB,MAAA,WAAW,EAAE,KALI;AAKG;AACpB,MAAA,OAAO,EAAE,KAAK,OANG;AAOjB,MAAA,iBAAiB,EAAE,IAPF;AAOQ;AACzB,MAAA,kBAAkB,EAAE,IARH;AAQS;AAC1B,MAAA,OAAO,EAAE,KAAK,WATG;AASU;AAC3B,MAAA,OAAO,qRAVU;AAaX,MAAA,qBAbW,iCAaW,QAbX,EAaqB,OAbrB,EAa8B,OAb9B,EAauC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAChD,kBAAA,IADgD,GACzC,IAAI,IAAJ,CAAS,CAAC,QAAQ,CAAC,IAAT,EAAD,CAAT,EAA4B,QAAQ,CAAC,QAAT,EAA5B,EAAiD;AAC5D,oBAAA,IAAI,EAAE;AADsD,mBAAjD,CADyC;AAItD,kBAAA,IAAI,CAAC,UAAD,EAAa;AAAE,oBAAA,IAAG,EAAH;AAAF,mBAAb,CAAJ,CACG,IADH,CACQ,UAAA,GAAE,EAAK;AAAA;;AACX,wBAAI,GAAG,CAAC,MAAJ,aAAc,GAAG,CAAC,CAAD,CAAjB,kCAAc,MAAQ,GAA1B,EAA+B;AAC7B,sBAAA,OAAO,CAAC,GAAG,CAAC,CAAD,CAAH,CAAO,GAAR,CAAP;AACF;AACD,mBALH,EAMG,KANH,CAMS,UAAA,GAAE;AAAA,2BAAK,OAAO,CAAC,GAAD,CAAZ;AAAA,mBANX;;AAJsD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWvD;AAxBgB,KAAnB;AA0BD,GAnEY;AAoEb,EAAA,OApEa,qBAoEH;AACR,QAAI,KAAK,cAAT,EAAyB;AACvB,WAAK,OAAL,GAAe,KAAK,cAApB;AACF;AACD,GAxEY;AAyEb,EAAA,KAAK,EAAE;AACL,IAAA,OAAO,EAAE;AACP,MAAA,OADO,qBACG;AACR,aAAK,KAAL,CAAW,QAAX,EAAqB,KAAK,OAA1B;AACD;AAHM,KADJ;AAML,IAAA,cAAc,EAAE;AACd,MAAA,OADc,qBACJ;AACR,aAAK,OAAL,GAAe,KAAK,cAApB;AACD,OAHa;AAId,MAAA,SAAS,EAAE;AAJG;AANX,GAzEM;AAsFb,EAAA,SAtFa,uBAsFD;AACV,SAAK,WAAL;AACD;AAxFY,CAAf","sourcesContent":["<template>\n  <div>\n    <editor id=\"tinymceEditor\" :init=\"tinymceInit\" v-model=\"content\" :key=\"tinymceFlag\"></editor>\n  </div>\n</template>\n<script>\nimport Editor from '@tinymce/tinymce-vue'\nimport { post } from '@/lin/plugin/axios'\n\nexport default {\n  name: 'TinymceEditor',\n  props: {\n    defaultContent: {\n      type: String,\n      default: '',\n    },\n    height: {\n      type: Number,\n      default: 500,\n    },\n    width: {\n      type: Number,\n      default: undefined,\n    },\n    showMenubar: {\n      type: Boolean,\n      default: true,\n    },\n    toolbar: {\n      type: String,\n      default: ` undo redo\n      | formatselect\n      | bold italic strikethrough forecolor backcolor formatpainter\n      | link image | alignleft aligncenter alignright alignjustify\n      | numlist bullist outdent indent\n      | removeformat\n      | preview fullscreen code`,\n    },\n  },\n  components: {\n    Editor,\n  },\n  data() {\n    return {\n      content: '',\n      tinymceFlag: 1,\n      tinymceInit: {},\n    }\n  },\n  created() {\n    this.tinymceInit = {\n      language: 'zh_CN',\n      height: this.height,\n      branding: true, // 去水印\n      statusbar: false, // 隐藏编辑器底部的状态栏\n      elementpath: false, // 禁用编辑器底部的状态栏\n      toolbar: this.toolbar,\n      paste_data_images: true, // 允许粘贴图像\n      browser_spellcheck: true, // 拼写检查\n      menubar: this.showMenubar, // 隐藏最上方menu\n      plugins: `print fullpage searchreplace autolink directionality visualblocks\n        visualchars template codesample charmap hr pagebreak nonbreaking anchor toc insertdatetime\n        wordcount textpattern help advlist table lists paste preview fullscreen image imagetools code link`,\n      async images_upload_handler(blobInfo, success, failure) {\n        const file = new File([blobInfo.blob()], blobInfo.filename(), {\n          type: 'image/*',\n        })\n        post('cms/file', { file })\n          .then(res => {\n            if (res.length && res[0]?.url) {\n              success(res[0].url)\n            }\n          })\n          .catch(err => failure(err))\n      },\n    }\n  },\n  mounted() {\n    if (this.defaultContent) {\n      this.content = this.defaultContent\n    }\n  },\n  watch: {\n    content: {\n      handler() {\n        this.$emit('change', this.content)\n      },\n    },\n    defaultContent: {\n      handler() {\n        this.content = this.defaultContent\n      },\n      immediate: true,\n    },\n  },\n  activated() {\n    this.tinymceFlag++\n  },\n}\n</script>\n\n<style lang=\"scss\">\n.tox-notification {\n  display: none !important;\n}\n</style>\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}