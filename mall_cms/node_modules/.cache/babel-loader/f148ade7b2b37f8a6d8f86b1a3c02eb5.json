{"ast":null,"code":"import _objectSpread from \"/Users/zhahn/Documents/Hahn/\\u81EA\\u8003/\\u9879\\u76EE/mall_cms/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _asyncToGenerator from \"/Users/zhahn/Documents/Hahn/\\u81EA\\u8003/\\u9879\\u76EE/mall_cms/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"regenerator-runtime/runtime.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport Coupon from '@/model/coupon';\nexport default {\n  props: {\n    isCreate: {\n      type: Boolean,\n      default: false\n    },\n    couponTemplateId: {\n      type: Number,\n      default: 0\n    }\n  },\n  data: function data() {\n    return {\n      form: {\n        title: '',\n        description: '',\n        full_money: null,\n        minus: null,\n        discount: null,\n        type: null\n      },\n      types: []\n    };\n  },\n  mounted: function mounted() {\n    var _this = this;\n\n    return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n      var res;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _this.types = Coupon.types;\n\n              if (_this.isCreate) {\n                _context.next = 6;\n                break;\n              }\n\n              _context.next = 4;\n              return Coupon.getCouponTemplate(_this.couponTemplateId);\n\n            case 4:\n              res = _context.sent;\n              _this.form = res;\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }))();\n  },\n  methods: {\n    submitForm: function submitForm(formName) {\n      var _this2 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {\n        var form, res;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                form = _objectSpread({}, _this2.form);\n\n                if (!_this2.isCreate) {\n                  _context3.next = 8;\n                  break;\n                }\n\n                form.banner_id = _this2.bannerId;\n                _context3.next = 5;\n                return Coupon.addCouponTemplate(form);\n\n              case 5:\n                res = _context3.sent;\n                _context3.next = 11;\n                break;\n\n              case 8:\n                _context3.next = 10;\n                return Coupon.editCouponTemplate(_this2.couponTemplateId, form);\n\n              case 10:\n                res = _context3.sent;\n\n              case 11:\n                if (res.code < window.MAX_SUCCESS_CODE) {\n                  _this2.$message.success(\"\".concat(res.message));\n\n                  _this2.resetForm(formName);\n\n                  _this2.$confirm('是否返回上一页?', '提示', {\n                    confirmButtonText: '是',\n                    cancelButtonText: '否',\n                    type: 'info'\n                  }).then( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n                    return regeneratorRuntime.wrap(function _callee2$(_context2) {\n                      while (1) {\n                        switch (_context2.prev = _context2.next) {\n                          case 0:\n                            _this2.$emit('editClose');\n\n                          case 1:\n                          case \"end\":\n                            return _context2.stop();\n                        }\n                      }\n                    }, _callee2);\n                  })));\n                }\n\n              case 12:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }))();\n    },\n    // 重置表单\n    resetForm: function resetForm(formName) {\n      this.$refs[formName].resetFields();\n    },\n    back: function back() {\n      this.$emit('editClose');\n    }\n  }\n};","map":{"version":3,"sources":["/Users/zhahn/Documents/Hahn/自考/项目/mall_cms/src/view/coupon/CouponTemplateEdit.vue"],"names":[],"mappings":";;;;AAqDA,OAAO,MAAP,MAAmB,gBAAnB;AAEA,eAAe;AACb,EAAA,KAAK,EAAE;AACL,IAAA,QAAQ,EAAE;AACR,MAAA,IAAI,EAAE,OADE;AAER,MAAA,OAAO,EAAE;AAFD,KADL;AAKL,IAAA,gBAAgB,EAAE;AAChB,MAAA,IAAI,EAAE,MADU;AAEhB,MAAA,OAAO,EAAE;AAFO;AALb,GADM;AAWb,EAAA,IAXa,kBAWN;AACL,WAAO;AACL,MAAA,IAAI,EAAE;AACJ,QAAA,KAAK,EAAE,EADH;AAEJ,QAAA,WAAW,EAAE,EAFT;AAGJ,QAAA,UAAU,EAAE,IAHR;AAIJ,QAAA,KAAK,EAAE,IAJH;AAKJ,QAAA,QAAQ,EAAE,IALN;AAMJ,QAAA,IAAI,EAAE;AANF,OADD;AASL,MAAA,KAAK,EAAE;AATF,KAAP;AAWD,GAvBY;AAwBP,EAAA,OAxBO,qBAwBG;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACd,cAAA,KAAI,CAAC,KAAL,GAAa,MAAM,CAAC,KAApB;;AADc,kBAET,KAAI,CAAC,QAFI;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAGM,MAAM,CAAC,iBAAP,CAAyB,KAAI,CAAC,gBAA9B,CAHN;;AAAA;AAGN,cAAA,GAHM;AAIZ,cAAA,KAAI,CAAC,IAAL,GAAY,GAAZ;;AAJY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMf,GA9BY;AA+Bb,EAAA,OAAO,EAAE;AACD,IAAA,UADC,sBACU,QADV,EACoB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACnB,gBAAA,IADmB,qBACP,MAAI,CAAC,IADE;;AAAA,qBAGrB,MAAI,CAAC,QAHgB;AAAA;AAAA;AAAA;;AAIvB,gBAAA,IAAI,CAAC,SAAL,GAAiB,MAAI,CAAC,QAAtB;AAJuB;AAAA,uBAKX,MAAM,CAAC,iBAAP,CAAyB,IAAzB,CALW;;AAAA;AAKvB,gBAAA,GALuB;AAAA;AAAA;;AAAA;AAAA;AAAA,uBAOX,MAAM,CAAC,kBAAP,CAA0B,MAAI,CAAC,gBAA/B,EAAiD,IAAjD,CAPW;;AAAA;AAOvB,gBAAA,GAPuB;;AAAA;AASzB,oBAAI,GAAG,CAAC,IAAJ,GAAW,MAAM,CAAC,gBAAtB,EAAwC;AACtC,kBAAA,MAAI,CAAC,QAAL,CAAc,OAAd,WAAyB,GAAG,CAAC,OAA7B;;AACA,kBAAA,MAAI,CAAC,SAAL,CAAe,QAAf;;AACA,kBAAA,MAAI,CAAC,QAAL,CAAc,UAAd,EAA0B,IAA1B,EAAgC;AAC9B,oBAAA,iBAAiB,EAAE,GADW;AAE9B,oBAAA,gBAAgB,EAAE,GAFY;AAG9B,oBAAA,IAAI,EAAE;AAHwB,mBAAhC,EAIG,IAJH,uEAIQ;AAAA;AAAA;AAAA;AAAA;AACN,4BAAA,MAAI,CAAC,KAAL,CAAW,WAAX;;AADM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAJR;AAOF;;AAnByB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAoB1B,KArBM;AAsBP;AACA,IAAA,SAvBO,qBAuBG,QAvBH,EAuBa;AAClB,WAAK,KAAL,CAAW,QAAX,EAAqB,WAArB;AACD,KAzBM;AA0BP,IAAA,IA1BO,kBA0BA;AACL,WAAK,KAAL,CAAW,WAAX;AACD;AA5BM;AA/BI,CAAf","sourcesContent":["<template>\n  <div class=\"container\">\n    <div class=\"title\">\n      <span>{{ isCreate ? '创建优惠卷模板' : '更新优惠卷模板' }}</span>\n      <span class=\"back\" @click=\"back\"> <i class=\"iconfont icon-fanhui\"></i> 返回 </span>\n    </div>\n    <div class=\"wrap\">\n      <el-row>\n        <el-col :lg=\"16\" :md=\"20\" :sm=\"24\" :xs=\"24\">\n          <el-form :model=\"form\" status-icon ref=\"form\" label-width=\"100px\" @submit.native.prevent>\n            <el-form-item label=\"类型\" prop=\"type\">\n              <el-select v-model=\"form.type\" placeholder=\"请填写类型\">\n                <el-option v-for=\"(item, index) in types\" :key=\"item\" :label=\"item\" :value=\"index + 1\"></el-option>\n              </el-select>\n            </el-form-item>\n\n            <el-form-item label=\"标题\" prop=\"title\">\n              <el-input size=\"medium\" v-model=\"form.title\" placeholder=\"请填写优惠卷标题\"></el-input>\n            </el-form-item>\n\n            <el-form-item label=\"描述\" prop=\"description\">\n              <el-input size=\"medium\" v-model=\"form.description\" placeholder=\"请填写优惠卷描述\"></el-input>\n            </el-form-item>\n\n            <el-form-item label=\"满减额\" prop=\"full_money\" v-if=\"form.type === 1 || form.type === 4\">\n              <el-input-number v-model=\"form.full_money\" :precision=\"2\" :step=\"1\"></el-input-number>\n            </el-form-item>\n\n            <el-form-item label=\"优惠额\" prop=\"minus\" v-if=\"form.type === 1 || form.type === 3\">\n              <el-input-number v-model=\"form.minus\" :precision=\"2\" :step=\"1\"></el-input-number>\n            </el-form-item>\n\n            <el-form-item label=\"折扣\" prop=\"discount\" v-if=\"form.type === 2 || form.type === 4\">\n              <el-input-number v-model=\"form.discount\" :precision=\"2\" :step=\"0.1\" :max=\"1\"></el-input-number>\n            </el-form-item>\n\n            <el-form-item class=\"submit\">\n              <el-button\n                v-permission=\"{ permission: ['创建优惠卷模板', '更新优惠卷模板'], type: 'disabled' }\"\n                type=\"primary\"\n                @click=\"submitForm('form')\"\n                >保 存</el-button\n              >\n              <el-button @click=\"resetForm('form')\">重 置</el-button>\n            </el-form-item>\n          </el-form>\n        </el-col>\n      </el-row>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Coupon from '@/model/coupon'\n\nexport default {\n  props: {\n    isCreate: {\n      type: Boolean,\n      default: false,\n    },\n    couponTemplateId: {\n      type: Number,\n      default: 0,\n    },\n  },\n  data() {\n    return {\n      form: {\n        title: '',\n        description: '',\n        full_money: null,\n        minus: null,\n        discount: null,\n        type: null,\n      },\n      types: [],\n    }\n  },\n  async mounted() {\n    this.types = Coupon.types\n    if (!this.isCreate) {\n      const res = await Coupon.getCouponTemplate(this.couponTemplateId)\n      this.form = res\n    }\n  },\n  methods: {\n    async submitForm(formName) {\n      const form = { ...this.form }\n      let res\n      if (this.isCreate) {\n        form.banner_id = this.bannerId\n        res = await Coupon.addCouponTemplate(form)\n      } else {\n        res = await Coupon.editCouponTemplate(this.couponTemplateId, form)\n      }\n      if (res.code < window.MAX_SUCCESS_CODE) {\n        this.$message.success(`${res.message}`)\n        this.resetForm(formName)\n        this.$confirm('是否返回上一页?', '提示', {\n          confirmButtonText: '是',\n          cancelButtonText: '否',\n          type: 'info',\n        }).then(async () => {\n          this.$emit('editClose')\n        })\n      }\n    },\n    // 重置表单\n    resetForm(formName) {\n      this.$refs[formName].resetFields()\n    },\n    back() {\n      this.$emit('editClose')\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.el-divider--horizontal {\n  margin: 0;\n}\n\n.container {\n  .title {\n    height: 59px;\n    line-height: 59px;\n    color: $parent-title-color;\n    font-size: 16px;\n    font-weight: 500;\n    text-indent: 40px;\n\n    .back {\n      float: right;\n      margin-right: 40px;\n      cursor: pointer;\n    }\n  }\n\n  .wrap {\n    padding: 20px;\n  }\n\n  .submit {\n    float: left;\n  }\n}\n\n.my-autocomplete {\n  li {\n    line-height: normal;\n    padding: 7px;\n    display: inline-flex;\n    align-content: space-around;\n    .name {\n      text-overflow: ellipsis;\n      overflow: hidden;\n    }\n    .id {\n      margin-right: 15px;\n      font-size: 12px;\n      color: #b4b4b4;\n    }\n\n    .highlighted .addr {\n      color: #ddd;\n    }\n  }\n}\n</style>\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}