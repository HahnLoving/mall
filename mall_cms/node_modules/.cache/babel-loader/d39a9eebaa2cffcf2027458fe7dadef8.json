{"ast":null,"code":"import _objectSpread from \"/Users/zhahn/Documents/Hahn/\\u81EA\\u8003/\\u9879\\u76EE/mall_cms/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _asyncToGenerator from \"/Users/zhahn/Documents/Hahn/\\u81EA\\u8003/\\u9879\\u76EE/mall_cms/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"regenerator-runtime/runtime.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.split.js\";\nimport \"core-js/modules/es.array.join.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport Spu from '@/model/spu';\nimport Category from '@/model/category';\nimport Sku from '@/model/sku';\nimport SpecKey from '@/model/spec-key';\nimport UploadImgs from '@/component/base/upload-image';\nimport DynamicTag from '@/component/tag/DynamicTag.vue';\nexport default {\n  components: {\n    UploadImgs: UploadImgs,\n    DynamicTag: DynamicTag\n  },\n  props: {\n    isCreate: {\n      type: Boolean,\n      default: false\n    },\n    spuId: {\n      type: String,\n      default: null\n    }\n  },\n  data: function data() {\n    return {\n      form: {\n        title: '',\n        subtitle: '',\n        rate_price: null,\n        category_id: null,\n        online: 1,\n        price: null,\n        sketch_spec_id: null,\n        default_sku_id: null,\n        img: null,\n        description: null,\n        spu_img_list: null,\n        spu_detail_img_list: null\n      },\n      rules: {\n        minWidth: 100,\n        minHeight: 100,\n        maxSize: 5\n      },\n      dynamicTags: [],\n      initData: [],\n      initThemeData: [],\n      initBannerData: [],\n      initDetailData: [],\n      maxNum: 5,\n      mainMaxNun: 1,\n      saled: true,\n      categoryState: '',\n      specKeyState: '',\n      skuState: '',\n      categorySuggestions: [],\n      specKeySuggestions: [],\n      skuSuggestions: [],\n      specs: [],\n      cascaderProps: {\n        lazy: true,\n        multiple: true,\n        lazyLoad: function lazyLoad(node, resolve) {\n          var _this = this;\n\n          return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n            var level, suggestions, nodes;\n            return regeneratorRuntime.wrap(function _callee$(_context) {\n              while (1) {\n                switch (_context.prev = _context.next) {\n                  case 0:\n                    level = node.level;\n                    _context.prev = 1;\n                    _context.next = 4;\n                    return SpecKey.getList();\n\n                  case 4:\n                    suggestions = _context.sent;\n                    nodes = suggestions.map(function (item) {\n                      return {\n                        value: item.id,\n                        label: \"\".concat(item.id, \" - \").concat(item.name),\n                        leaf: level >= 0\n                      };\n                    });\n                    resolve(nodes);\n                    _context.next = 12;\n                    break;\n\n                  case 9:\n                    _context.prev = 9;\n                    _context.t0 = _context[\"catch\"](1);\n\n                    _this.$message.error('获取规格信息失败，请检查网络');\n\n                  case 12:\n                  case \"end\":\n                    return _context.stop();\n                }\n              }\n            }, _callee, null, [[1, 9]]);\n          }))();\n        }\n      }\n    };\n  },\n  watch: {\n    saled: function saled(val) {\n      this.form.online = val ? 1 : 0;\n    }\n  },\n  mounted: function mounted() {\n    var _this2 = this;\n\n    return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n      var res, initData, hitSpecKeys;\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (_this2.isCreate) {\n                _context2.next = 19;\n                break;\n              }\n\n              _context2.next = 3;\n              return Spu.getDetail(_this2.spuId);\n\n            case 3:\n              res = _context2.sent;\n              _this2.form = res;\n              initData = [{\n                id: res.id,\n                display: res.img\n              }];\n              _this2.saled = res.online === 1;\n              _this2.initData = initData;\n              _this2.initThemeData = [{\n                id: res.id,\n                display: res.for_theme_img\n              }]; // eslint-disable-next-line\n\n              _this2.initBannerData = res.spu_img_list ? res.spu_img_list.map(function (it, index) {\n                return {\n                  id: index,\n                  display: it\n                };\n              }) : []; // eslint-disable-next-line\n\n              _this2.initDetailData = res.spu_detail_img_list ? res.spu_detail_img_list.map(function (it, index) {\n                return {\n                  id: index,\n                  display: it\n                };\n              }) : [];\n              _this2.specKeyState = res.sketch_spec_key_name;\n              _this2.categoryState = res.category_name;\n              _this2.skuState = res.default_sku_title;\n              _context2.next = 16;\n              return Spu.getSpecKeys(_this2.spuId);\n\n            case 16:\n              hitSpecKeys = _context2.sent;\n              _this2.specs = hitSpecKeys.map(function (item) {\n                return [item];\n              });\n              _this2.dynamicTags = res.tags ? res.tags.split('$') : [];\n\n            case 19:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }))();\n  },\n  methods: {\n    // eslint-disable-next-line\n    submitForm: function submitForm(formName) {\n      var _this3 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {\n        var postData, tags, res;\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return _this3.getValue();\n\n              case 2:\n                postData = _objectSpread({}, _this3.form);\n                tags = _this3.dynamicTags.join('$');\n                postData.spec_key_id_list = _this3.specs.map(function (spec) {\n                  return spec[0];\n                });\n                postData.tags = tags;\n\n                if (!_this3.isCreate) {\n                  _context4.next = 12;\n                  break;\n                }\n\n                _context4.next = 9;\n                return Spu.addSpu(postData);\n\n              case 9:\n                res = _context4.sent;\n                _context4.next = 15;\n                break;\n\n              case 12:\n                _context4.next = 14;\n                return Spu.editSpu(_this3.spuId, postData);\n\n              case 14:\n                res = _context4.sent;\n\n              case 15:\n                if (res.code < window.MAX_SUCCESS_CODE) {\n                  _this3.$message.success(\"\".concat(res.message)); // this.resetForm(formName)\n\n\n                  _this3.$confirm('是否返回上一页', '提示', {\n                    confirmButtonText: '确定',\n                    cancelButtonText: '取消',\n                    type: 'warning'\n                  }).then( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {\n                    return regeneratorRuntime.wrap(function _callee3$(_context3) {\n                      while (1) {\n                        switch (_context3.prev = _context3.next) {\n                          case 0:\n                            _this3.$emit('editClose');\n\n                          case 1:\n                          case \"end\":\n                            return _context3.stop();\n                        }\n                      }\n                    }, _callee3);\n                  })));\n                }\n\n              case 16:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4);\n      }))();\n    },\n    // 重置表单\n    resetForm: function resetForm(formName) {\n      this.$refs[formName].resetFields();\n    },\n    queryCategorySearch: function queryCategorySearch(queryString, cb) {\n      // eslint-disable-next-line\n      var suggestions = this.categorySuggestions;\n      var results = queryString ? suggestions.filter(this.createCategoryFilter(queryString)) : suggestions;\n      cb(results);\n    },\n    querySpecKeySearch: function querySpecKeySearch(queryString, cb) {\n      // eslint-disable-next-line\n      var suggestions = this.specKeySuggestions;\n      var results = queryString ? suggestions.filter(this.createCategoryFilter(queryString)) : suggestions;\n      cb(results);\n    },\n    querySkuSearch: function querySkuSearch(queryString, cb) {\n      // eslint-disable-next-line\n      var suggestions = this.skuSuggestions;\n      var results = queryString ? suggestions.filter(this.createSkuFilter(queryString)) : suggestions;\n      cb(results);\n    },\n    createCategoryFilter: function createCategoryFilter(queryString) {\n      // eslint-disable-next-line\n      return function (suggestion) {\n        return suggestion.name.toLowerCase().indexOf(queryString.toLowerCase()) === 0;\n      };\n    },\n    createSkuFilter: function createSkuFilter(queryString) {\n      // eslint-disable-next-line\n      return function (suggestion) {\n        return suggestion.title.toLowerCase().indexOf(queryString.toLowerCase()) === 0;\n      };\n    },\n    handleCategorySelect: function handleCategorySelect(item) {\n      this.categoryState = item.name;\n      this.form.category_id = item.id;\n    },\n    handleSpecKeySelect: function handleSpecKeySelect(item) {\n      this.specKeyState = item.name;\n      this.form.sketch_spec_id = item.id;\n    },\n    handleSkuSelect: function handleSkuSelect(item) {\n      this.skuState = item.title;\n      this.form.default_sku_id = item.id;\n    },\n    getValue: function getValue() {\n      var _this4 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5() {\n        var val, val3, val1, val2;\n        return regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.next = 2;\n                return _this4.$refs.uploadEle.getValue();\n\n              case 2:\n                val = _context5.sent;\n\n                if (val && val.length > 0) {\n                  _this4.form.img = val[0].display;\n                }\n\n                _context5.next = 6;\n                return _this4.$refs.uploadThmeEle.getValue();\n\n              case 6:\n                val3 = _context5.sent;\n\n                if (val3 && val3.length > 0) {\n                  _this4.form.for_theme_img = val3[0].display;\n                }\n\n                _context5.next = 10;\n                return _this4.$refs.uploadBannerEle.getValue();\n\n              case 10:\n                val1 = _context5.sent;\n\n                if (val1 && val1.length > 0) {\n                  _this4.form.spu_img_list = val1.map(function (it) {\n                    return it.display;\n                  });\n                }\n\n                _context5.next = 14;\n                return _this4.$refs.uploadDetailEle.getValue();\n\n              case 14:\n                val2 = _context5.sent;\n\n                if (val2 && val2.length > 0) {\n                  _this4.form.spu_detail_img_list = val2.map(function (it) {\n                    return it.display;\n                  });\n                }\n\n              case 16:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5);\n      }))();\n    },\n    back: function back() {\n      this.$emit('editClose');\n    },\n    loadCategorySuggestions: function loadCategorySuggestions() {\n      var _this5 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6() {\n        return regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                if (!(_this5.categorySuggestions.length > 0)) {\n                  _context6.next = 2;\n                  break;\n                }\n\n                return _context6.abrupt(\"return\");\n\n              case 2:\n                _context6.prev = 2;\n                _context6.next = 5;\n                return Category.getList();\n\n              case 5:\n                _this5.categorySuggestions = _context6.sent;\n\n                if (_this5.categorySuggestions.length === 0) {\n                  _this5.$message.error('暂无分类，请先添加');\n                }\n\n                _context6.next = 13;\n                break;\n\n              case 9:\n                _context6.prev = 9;\n                _context6.t0 = _context6[\"catch\"](2);\n\n                _this5.$message.error('获取分类建议信息失败');\n\n                console.error(_context6.t0);\n\n              case 13:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, null, [[2, 9]]);\n      }))();\n    },\n    loadSpecKeySuggestions: function loadSpecKeySuggestions() {\n      var _this6 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7() {\n        return regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                if (!(_this6.specKeySuggestions.length > 0)) {\n                  _context7.next = 2;\n                  break;\n                }\n\n                return _context7.abrupt(\"return\");\n\n              case 2:\n                _context7.prev = 2;\n\n                if (_this6.isCreate) {\n                  _context7.next = 9;\n                  break;\n                }\n\n                _context7.next = 6;\n                return SpecKey.getBySpuId(_this6.spuId);\n\n              case 6:\n                _this6.specKeySuggestions = _context7.sent;\n                _context7.next = 10;\n                break;\n\n              case 9:\n                _this6.specKeySuggestions = _this6.specs;\n\n              case 10:\n                if (_this6.specKeySuggestions.length === 0) {\n                  _this6.$message.error('暂无规格名，请先添加');\n                }\n\n                _context7.next = 17;\n                break;\n\n              case 13:\n                _context7.prev = 13;\n                _context7.t0 = _context7[\"catch\"](2);\n\n                _this6.$message.error('获取规格键建议信息失败');\n\n                console.error(_context7.t0);\n\n              case 17:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, null, [[2, 13]]);\n      }))();\n    },\n    loadSkuSuggestions: function loadSkuSuggestions() {\n      var _this7 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee8() {\n        return regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                if (!(_this7.skuSuggestions.length > 0)) {\n                  _context8.next = 2;\n                  break;\n                }\n\n                return _context8.abrupt(\"return\");\n\n              case 2:\n                if (_this7.isCreate) {\n                  _context8.next = 7;\n                  break;\n                }\n\n                _context8.next = 5;\n                return Sku.getBySpuId(_this7.spuId);\n\n              case 5:\n                _this7.skuSuggestions = _context8.sent;\n\n                if (_this7.skuSuggestions.length === 0) {\n                  _this7.$message.error('暂无SKU，请先添加');\n                }\n\n              case 7:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8);\n      }))();\n    }\n  }\n};","map":{"version":3,"sources":["/Users/zhahn/Documents/Hahn/自考/项目/mall_cms/src/view/spu/spu-edit.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <sticky-top>\n      <div class=\"title\">\n        <span>{{ isCreate ? '创建SPU' : '更新SPU' }}</span>\n        <span class=\"back\" @click=\"back\"> <i class=\"iconfont icon-fanhui\"></i> 返回 </span>\n        <el-divider></el-divider>\n      </div>\n    </sticky-top>\n    <div class=\"container\">\n      <div class=\"wrap\">\n        <el-row>\n          <el-col :lg=\"16\" :md=\"20\" :sm=\"24\" :xs=\"24\">\n            <el-form :model=\"form\" status-icon ref=\"form\" label-width=\"100px\" @submit.native.prevent>\n              <el-form-item label=\"标题\" prop=\"title\">\n                <el-input size=\"medium\" v-model=\"form.title\" placeholder=\"请填写标题\"></el-input>\n              </el-form-item>\n              <el-form-item label=\"副标题\" prop=\"subtitle\">\n                <el-input size=\"medium\" v-model=\"form.subtitle\" placeholder=\"请填写副标题\"></el-input>\n              </el-form-item>\n              <el-form-item label=\"价格\" prop=\"price\">\n                <el-input size=\"medium\" v-model=\"form.price\" placeholder=\"请填写价格\"></el-input>\n              </el-form-item>\n              <el-form-item label=\"折扣\" prop=\"rate_price\">\n                <el-input size=\"medium\" v-model=\"form.rate_price\" placeholder=\"请填写折扣\"></el-input>\n              </el-form-item>\n              <el-form-item label=\"分类\" prop=\"category_id\">\n                <el-autocomplete\n                  @focus=\"loadCategorySuggestions\"\n                  popper-class=\"my-autocomplete\"\n                  class=\"inline-input\"\n                  v-model=\"categoryState\"\n                  :fetch-suggestions=\"queryCategorySearch\"\n                  placeholder=\"请填写所属分类\"\n                  @select=\"handleCategorySelect\"\n                >\n                  <template #default=\"{ item }\">\n                    <span class=\"id\">{{ item.id }}</span>\n                    <span class=\"name\">{{ item.name }}</span>\n                  </template>\n                </el-autocomplete>\n              </el-form-item>\n              <el-form-item label=\"默认sku\" prop=\"default_sku_id\">\n                <el-autocomplete\n                  @focus=\"loadSkuSuggestions\"\n                  popper-class=\"my-autocomplete\"\n                  class=\"inline-input\"\n                  v-model=\"skuState\"\n                  :fetch-suggestions=\"querySkuSearch\"\n                  placeholder=\"请填写默认sku\"\n                  @select=\"handleSkuSelect\"\n                >\n                  <template #default=\"{ item }\">\n                    <span class=\"id\">{{ item.id }}</span>\n                    <span class=\"name\">{{ item.title }}</span>\n                  </template>\n                </el-autocomplete>\n              </el-form-item>\n\n              <el-form-item label=\"是否上架\">\n                <el-switch\n                  size=\"medium\"\n                  v-model=\"saled\"\n                  active-color=\"#13ce66\"\n                  inactive-color=\"#ff4949\"\n                  active-text=\"上架\"\n                  inactive-text=\"下架\"\n                ></el-switch>\n              </el-form-item>\n\n              <el-form-item label=\"主图\" prop=\"img\">\n                <el-tooltip\n                  class=\"item\"\n                  effect=\"dark\"\n                  content=\"主图可以选择不上传，默认选择轮播图的第一张为主图\"\n                  placement=\"top-start\"\n                >\n                  <upload-imgs multiple :max-num=\"mainMaxNun\" ref=\"uploadEle\" :value=\"initData\" />\n                </el-tooltip>\n              </el-form-item>\n\n              <el-form-item label=\"主题图\" prop=\"for_theme_img\">\n                <upload-imgs :max-num=\"mainMaxNun\" ref=\"uploadThmeEle\" :value=\"initThemeData\" />\n              </el-form-item>\n\n              <el-form-item label=\"轮播图\" prop=\"spu_img_list\">\n                <upload-imgs multiple sortable :max-num=\"maxNum\" ref=\"uploadBannerEle\" :value=\"initBannerData\" />\n              </el-form-item>\n\n              <el-form-item label=\"详情图\" prop=\"spu_detail_img_list\">\n                <upload-imgs multiple sortable :max-num=\"maxNum\" ref=\"uploadDetailEle\" :value=\"initDetailData\" />\n              </el-form-item>\n\n              <el-form-item label=\"标签\" prop=\"tags\">\n                <!-- <dynamic-tag v-model=\"dynamicTags\" :dynamicTags=\"dynamicTags\"></dynamic-tag> -->\n                  <dynamic-tag :dynamicTags=\"dynamicTags\"></dynamic-tag>\n              </el-form-item>\n\n              <el-form-item label=\"选择规格\" prop=\"specs\">\n                <el-cascader placeholder=\"选择规格（可多选）\" v-model=\"specs\" :props=\"cascaderProps\"></el-cascader>\n              </el-form-item>\n\n              <!-- <el-form-item label=\"可视规格\" prop=\"sketch_spec_id\">\n                <el-autocomplete\n                  @focus=\"loadSpecKeySuggestions\"\n                  popper-class=\"my-autocomplete\"\n                  class=\"inline-input\"\n                  v-model=\"specKeyState\"\n                  :fetch-suggestions=\"querySpecKeySearch\"\n                  placeholder=\"请填写可视规格id\"\n                  @select=\"handleSpecKeySelect\"\n                >\n                  <template #default=\"{ item }\">\n                    <span class=\"id\">{{ item.id }}</span>\n                    <span class=\"name\">{{ item.name }}</span>\n                  </template>\n                </el-autocomplete>\n              </el-form-item> -->\n\n              <el-form-item label=\"描述\" prop=\"description\">\n                <el-input size=\"medium\" v-model=\"form.description\" placeholder=\"请填写描述\"></el-input>\n              </el-form-item>\n\n              <el-form-item class=\"submit\">\n                <el-button\n                  v-permission=\"{ permission: ['创建SPU', '更新SPU'], type: 'disabled' }\"\n                  type=\"primary\"\n                  @click=\"submitForm('form')\"\n                  >保 存</el-button\n                >\n                <!-- <el-button @click=\"resetForm('form')\">重 置</el-button> -->\n              </el-form-item>\n            </el-form>\n          </el-col>\n        </el-row>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Spu from '@/model/spu'\nimport Category from '@/model/category'\nimport Sku from '@/model/sku'\nimport SpecKey from '@/model/spec-key'\nimport UploadImgs from '@/component/base/upload-image'\nimport DynamicTag from '@/component/tag/DynamicTag.vue'\n\nexport default {\n  components: {\n    UploadImgs,\n    DynamicTag,\n  },\n  props: {\n    isCreate: {\n      type: Boolean,\n      default: false,\n    },\n    spuId: {\n      type: String,\n      default: null,\n    },\n  },\n  data() {\n    return {\n      form: {\n        title: '',\n        subtitle: '',\n        rate_price: null,\n        category_id: null,\n        online: 1,\n        price: null,\n        sketch_spec_id: null,\n        default_sku_id: null,\n        img: null,\n        description: null,\n        spu_img_list: null,\n        spu_detail_img_list: null,\n      },\n      rules: {\n        minWidth: 100,\n        minHeight: 100,\n        maxSize: 5,\n      },\n      dynamicTags: [],\n      initData: [],\n      initThemeData: [],\n      initBannerData: [],\n      initDetailData: [],\n      maxNum: 5,\n      mainMaxNun: 1,\n      saled: true,\n      categoryState: '',\n      specKeyState: '',\n      skuState: '',\n      categorySuggestions: [],\n      specKeySuggestions: [],\n      skuSuggestions: [],\n      specs: [],\n      cascaderProps: {\n        lazy: true,\n        multiple: true,\n        async lazyLoad(node, resolve) {\n          const { level } = node\n          try {\n            const suggestions = await SpecKey.getList()\n            const nodes = suggestions.map(item => ({\n              value: item.id,\n              label: `${item.id} - ${item.name}`,\n              leaf: level >= 0,\n            }))\n            resolve(nodes)\n          } catch (error) {\n            this.$message.error('获取规格信息失败，请检查网络')\n          }\n        },\n      },\n    }\n  },\n  watch: {\n    saled(val) {\n      this.form.online = val ? 1 : 0\n    },\n  },\n  async mounted() {\n    if (!this.isCreate) {\n      const res = await Spu.getDetail(this.spuId)\n      this.form = res\n      const initData = [\n        {\n          id: res.id,\n          display: res.img,\n        },\n      ]\n      this.saled = res.online === 1\n      this.initData = initData\n      this.initThemeData = [\n        {\n          id: res.id,\n          display: res.for_theme_img,\n        },\n      ]\n      // eslint-disable-next-line\n      this.initBannerData = res.spu_img_list ? res.spu_img_list.map((it, index) => ({ id: index, display: it })) : []\n      // eslint-disable-next-line\n      this.initDetailData = res.spu_detail_img_list\n        ? res.spu_detail_img_list.map((it, index) => ({ id: index, display: it }))\n        : []\n      this.specKeyState = res.sketch_spec_key_name\n      this.categoryState = res.category_name\n      this.skuState = res.default_sku_title\n      const hitSpecKeys = await Spu.getSpecKeys(this.spuId)\n      this.specs = hitSpecKeys.map(item => [item])\n      this.dynamicTags = res.tags ? res.tags.split('$') : []\n    }\n  },\n  methods: {\n    // eslint-disable-next-line\n    async submitForm(formName) {\n      await this.getValue()\n      const postData = { ...this.form }\n      const tags = this.dynamicTags.join('$')\n      postData.spec_key_id_list = this.specs.map(spec => spec[0])\n      postData.tags = tags\n      let res\n      if (this.isCreate) {\n        res = await Spu.addSpu(postData)\n      } else {\n        res = await Spu.editSpu(this.spuId, postData)\n      }\n      if (res.code < window.MAX_SUCCESS_CODE) {\n        this.$message.success(`${res.message}`)\n        // this.resetForm(formName)\n        this.$confirm('是否返回上一页', '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning',\n        }).then(async () => {\n          this.$emit('editClose')\n        })\n      }\n    },\n    // 重置表单\n    resetForm(formName) {\n      this.$refs[formName].resetFields()\n    },\n    queryCategorySearch(queryString, cb) {\n      // eslint-disable-next-line\n      const suggestions = this.categorySuggestions\n      const results = queryString ? suggestions.filter(this.createCategoryFilter(queryString)) : suggestions\n      cb(results)\n    },\n    querySpecKeySearch(queryString, cb) {\n      // eslint-disable-next-line\n      const suggestions = this.specKeySuggestions\n      const results = queryString ? suggestions.filter(this.createCategoryFilter(queryString)) : suggestions\n      cb(results)\n    },\n    querySkuSearch(queryString, cb) {\n      // eslint-disable-next-line\n      const suggestions = this.skuSuggestions\n      const results = queryString ? suggestions.filter(this.createSkuFilter(queryString)) : suggestions\n      cb(results)\n    },\n    createCategoryFilter(queryString) {\n      // eslint-disable-next-line\n      return suggestion => {\n        return suggestion.name.toLowerCase().indexOf(queryString.toLowerCase()) === 0\n      }\n    },\n    createSkuFilter(queryString) {\n      // eslint-disable-next-line\n      return suggestion => {\n        return suggestion.title.toLowerCase().indexOf(queryString.toLowerCase()) === 0\n      }\n    },\n    handleCategorySelect(item) {\n      this.categoryState = item.name\n      this.form.category_id = item.id\n    },\n    handleSpecKeySelect(item) {\n      this.specKeyState = item.name\n      this.form.sketch_spec_id = item.id\n    },\n    handleSkuSelect(item) {\n      this.skuState = item.title\n      this.form.default_sku_id = item.id\n    },\n    async getValue() {\n      const val = await this.$refs.uploadEle.getValue()\n      if (val && val.length > 0) {\n        this.form.img = val[0].display\n      }\n      const val3 = await this.$refs.uploadThmeEle.getValue()\n      if (val3 && val3.length > 0) {\n        this.form.for_theme_img = val3[0].display\n      }\n      const val1 = await this.$refs.uploadBannerEle.getValue()\n      if (val1 && val1.length > 0) {\n        this.form.spu_img_list = val1.map(it => it.display)\n      }\n      const val2 = await this.$refs.uploadDetailEle.getValue()\n      if (val2 && val2.length > 0) {\n        this.form.spu_detail_img_list = val2.map(it => it.display)\n      }\n    },\n    back() {\n      this.$emit('editClose')\n    },\n    async loadCategorySuggestions() {\n      if (this.categorySuggestions.length > 0) {\n        return\n      }\n      try {\n        this.categorySuggestions = await Category.getList()\n        if (this.categorySuggestions.length === 0) {\n          this.$message.error('暂无分类，请先添加')\n        }\n      } catch (error) {\n        this.$message.error('获取分类建议信息失败')\n        console.error(error)\n      }\n    },\n    async loadSpecKeySuggestions() {\n      if (this.specKeySuggestions.length > 0) {\n        return\n      }\n      try {\n        if (!this.isCreate) {\n          // 添加当前 spu_id\n          this.specKeySuggestions = await SpecKey.getBySpuId(this.spuId)\n        } else {\n          this.specKeySuggestions = this.specs\n        }\n        if (this.specKeySuggestions.length === 0) {\n          this.$message.error('暂无规格名，请先添加')\n        }\n      } catch (error) {\n        this.$message.error('获取规格键建议信息失败')\n        console.error(error)\n      }\n    },\n    async loadSkuSuggestions() {\n      if (this.skuSuggestions.length > 0) {\n        return\n      }\n      // 如果创建spu，则没有sku，不用建议\n      if (!this.isCreate) {\n        this.skuSuggestions = await Sku.getBySpuId(this.spuId)\n        if (this.skuSuggestions.length === 0) {\n          this.$message.error('暂无SKU，请先添加')\n        }\n      }\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.el-divider--horizontal {\n  margin: 0;\n}\n\n.container {\n  .title {\n    height: 59px;\n    line-height: 59px;\n    color: $parent-title-color;\n    font-size: 16px;\n    font-weight: 500;\n    text-indent: 40px;\n\n    .back {\n      float: right;\n      margin-right: 40px;\n      cursor: pointer;\n    }\n  }\n\n  .wrap {\n    padding: 20px;\n  }\n\n  .submit {\n    float: left;\n  }\n}\n\n.my-autocomplete {\n  li {\n    line-height: normal;\n    padding: 7px;\n    display: inline-flex;\n    align-content: space-around;\n    .name {\n      text-overflow: ellipsis;\n      overflow: hidden;\n    }\n    .id {\n      margin-right: 15px;\n      font-size: 12px;\n      color: #b4b4b4;\n    }\n\n    .highlighted .addr {\n      color: #ddd;\n    }\n  }\n}\n</style>\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}