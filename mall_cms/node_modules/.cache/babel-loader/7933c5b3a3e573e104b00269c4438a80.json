{"ast":null,"code":"import \"core-js/modules/es.function.name.js\";\nimport { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, createCommentVNode as _createCommentVNode, withModifiers as _withModifiers, resolveDirective as _resolveDirective, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\n\nvar _withScopeId = function _withScopeId(n) {\n  return _pushScopeId(\"data-v-74cf0d0a\"), n = n(), _popScopeId(), n;\n};\n\nvar _hoisted_1 = {\n  class: \"container\"\n};\n\nvar _hoisted_2 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"div\", {\n    class: \"title\"\n  }, \"新建分组信息\", -1\n  /* HOISTED */\n  );\n});\n\nvar _hoisted_3 = {\n  class: \"content\"\n};\n\nvar _hoisted_4 = /*#__PURE__*/_createTextVNode(\"保 存\");\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_el_input = _resolveComponent(\"el-input\");\n\n  var _component_el_form_item = _resolveComponent(\"el-form-item\");\n\n  var _component_group_permissions = _resolveComponent(\"group-permissions\");\n\n  var _component_el_button = _resolveComponent(\"el-button\");\n\n  var _component_el_form = _resolveComponent(\"el-form\");\n\n  var _component_el_col = _resolveComponent(\"el-col\");\n\n  var _component_el_row = _resolveComponent(\"el-row\");\n\n  var _directive_loading = _resolveDirective(\"loading\");\n\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_hoisted_2, _createVNode(_component_el_row, null, {\n    default: _withCtx(function () {\n      return [_createVNode(_component_el_col, {\n        lg: 16,\n        md: 20,\n        sm: 24,\n        xs: 24\n      }, {\n        default: _withCtx(function () {\n          return [_createElementVNode(\"div\", _hoisted_3, [_withDirectives(_createVNode(_component_el_form, {\n            ref: \"form\",\n            \"status-icon\": \"\",\n            rules: $setup.rules,\n            model: $setup.group,\n            \"label-position\": \"right\",\n            \"label-width\": \"100px\",\n            onSubmit: _cache[3] || (_cache[3] = _withModifiers(function () {}, [\"prevent\"]))\n          }, {\n            default: _withCtx(function () {\n              return [_createVNode(_component_el_form_item, {\n                label: \"分组名称\",\n                prop: \"name\"\n              }, {\n                default: _withCtx(function () {\n                  return [_createVNode(_component_el_input, {\n                    clearable: \"\",\n                    modelValue: $setup.group.name,\n                    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n                      return $setup.group.name = $event;\n                    })\n                  }, null, 8\n                  /* PROPS */\n                  , [\"modelValue\"])];\n                }),\n                _: 1\n                /* STABLE */\n\n              }), _createVNode(_component_el_form_item, {\n                label: \"分组描述\",\n                prop: \"info\"\n              }, {\n                default: _withCtx(function () {\n                  return [_createVNode(_component_el_input, {\n                    clearable: \"\",\n                    modelValue: $setup.group.info,\n                    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = function ($event) {\n                      return $setup.group.info = $event;\n                    })\n                  }, null, 8\n                  /* PROPS */\n                  , [\"modelValue\"])];\n                }),\n                _: 1\n                /* STABLE */\n\n              }), _createVNode(_component_el_form_item, null, {\n                default: _withCtx(function () {\n                  return [_createVNode(_component_group_permissions, {\n                    title: \"分配权限\",\n                    ref: \"groupPermissions\",\n                    onUpdatePermissions: $setup.updatePermissions\n                  }, null, 8\n                  /* PROPS */\n                  , [\"onUpdatePermissions\"])];\n                }),\n                _: 1\n                /* STABLE */\n\n              }), _createVNode(_component_el_form_item, {\n                class: \"submit\"\n              }, {\n                default: _withCtx(function () {\n                  return [_createVNode(_component_el_button, {\n                    type: \"primary\",\n                    onClick: _cache[2] || (_cache[2] = function ($event) {\n                      return $setup.submitForm('form');\n                    })\n                  }, {\n                    default: _withCtx(function () {\n                      return [_hoisted_4];\n                    }),\n                    _: 1\n                    /* STABLE */\n\n                  }), _createCommentVNode(\" <el-button @click=\\\"resetForm('form')\\\">重 置</el-button> \")];\n                }),\n                _: 1\n                /* STABLE */\n\n              })];\n            }),\n            _: 1\n            /* STABLE */\n\n          }, 8\n          /* PROPS */\n          , [\"rules\", \"model\"]), [[_directive_loading, $setup.loading]])])];\n        }),\n        _: 1\n        /* STABLE */\n\n      })];\n    }),\n    _: 1\n    /* STABLE */\n\n  })]);\n}","map":{"version":3,"sources":["/Users/zhahn/Documents/Hahn/自考/mall/mall_cms/src/view/admin/group/group-create.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"container\">\n    <div class=\"title\">新建分组信息</div>\n    <el-row>\n      <el-col :lg=\"16\" :md=\"20\" :sm=\"24\" :xs=\"24\">\n        <div class=\"content\">\n          <el-form\n            ref=\"form\"\n            status-icon\n            :rules=\"rules\"\n            :model=\"group\"\n            label-position=\"right\"\n            label-width=\"100px\"\n            v-loading=\"loading\"\n            @submit.prevent\n          >\n            <el-form-item label=\"分组名称\" prop=\"name\">\n              <el-input clearable v-model=\"group.name\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"分组描述\" prop=\"info\">\n              <el-input clearable v-model=\"group.info\"></el-input>\n            </el-form-item>\n            <el-form-item>\n              <group-permissions title=\"分配权限\" ref=\"groupPermissions\" @updatePermissions=\"updatePermissions\">\n              </group-permissions>\n            </el-form-item>\n            <el-form-item class=\"submit\">\n              <el-button type=\"primary\" @click=\"submitForm('form')\">保 存</el-button>\n              <!-- <el-button @click=\"resetForm('form')\">重 置</el-button> -->\n            </el-form-item>\n          </el-form>\n        </div>\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script>\nimport { useRouter } from 'vue-router'\nimport { ref, reactive } from 'vue'\nimport { ElMessage } from 'element-plus'\nimport AdminModel from '@/lin/model/admin'\nimport GroupPermissions from './group-permission'\n\nexport default {\n  components: {\n    GroupPermissions,\n  },\n  setup() {\n    /**\n     * 表单验证规则\n     */\n    const { rules } = getRules()\n\n    // originally data properties\n    const form = ref(null)\n    const groupPermissions = ref(null)\n\n    const loading = ref(false)\n    const router = useRouter()\n    const permissions = ref([])\n    const allPermissions = ref([])\n    const group = reactive({ name: '', info: '' })\n\n    /**\n     * 重置表单\n     */\n    const resetForm = () => {\n      form.value.resetFields()\n      groupPermissions.value.getGroupPermissions()\n    }\n\n    /**\n     * 提交表单\n     * 添加新的分组\n     */\n    const submitForm = async () => {\n      form.value.validate(async valid => {\n        if (valid) {\n          let res = {}\n          const finalPermissions = permissions.value.filter(x => Object.keys(allPermissions.value).indexOf(x) < 0)\n          try {\n            loading.value = true\n            res = await AdminModel.createOneGroup(group.name, group.info, finalPermissions)\n          } catch (e) {\n            loading.value = false\n            console.error(e)\n          }\n          if (res.code < window.MAX_SUCCESS_CODE) {\n            loading.value = false\n            ElMessage.success(`${res.message}`)\n            router.push('/admin/group/list')\n            resetForm()\n          } else {\n            loading.value = false\n          }\n        } else {\n          ElMessage.error('请将信息填写完整')\n        }\n      })\n    }\n\n    /**\n     * 编辑后的最终权限\n     */\n    const updatePermissions = picked => {\n      permissions.value = picked\n    }\n\n    return {\n      form,\n      rules,\n      group,\n      loading,\n      resetForm,\n      submitForm,\n      groupPermissions,\n      updatePermissions,\n    }\n  },\n}\n\nfunction getRules() {\n  const checkName = (rule, value, callback) => {\n    if (!value) {\n      return callback(new Error('分组名称不能为空'))\n    }\n    callback()\n  }\n  const rules = { info: [], name: [{ validator: checkName, trigger: ['blur', 'change'], required: true }] }\n  return { rules }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.container {\n  .title {\n    height: 59px;\n    line-height: 59px;\n    color: $parent-title-color;\n    font-size: 16px;\n    font-weight: 500;\n    text-indent: 40px;\n    border-bottom: 1px solid #dae1ec;\n  }\n\n  .content {\n    margin-top: 10px;\n    padding-left: 25px;\n    padding-right: 40px;\n  }\n\n  .submit {\n    float: left;\n  }\n}\n</style>\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}