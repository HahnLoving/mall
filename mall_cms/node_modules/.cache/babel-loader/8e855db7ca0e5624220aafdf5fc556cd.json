{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, createTextVNode as _createTextVNode, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\n\nvar _withScopeId = function _withScopeId(n) {\n  return _pushScopeId(\"data-v-2a3d95a6\"), n = n(), _popScopeId(), n;\n};\n\nvar _hoisted_1 = {\n  class: \"app-nav-bar\"\n};\nvar _hoisted_2 = {\n  class: \"nav-content\"\n};\nvar _hoisted_3 = {\n  class: \"right-info\"\n};\n\nvar _hoisted_4 = /*#__PURE__*/_createTextVNode();\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_breadcrumb = _resolveComponent(\"breadcrumb\");\n\n  var _component_lin_notify = _resolveComponent(\"lin-notify\");\n\n  var _component_clear_tab = _resolveComponent(\"clear-tab\");\n\n  var _component_screenfull = _resolveComponent(\"screenfull\");\n\n  var _component_user = _resolveComponent(\"user\");\n\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_breadcrumb), _createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_lin_notify, {\n    height: \"370\",\n    value: $data.value,\n    hidden: $data.hidden,\n    trigger: 'click',\n    onReadAll: $options.readAll,\n    onViewAll: $options.viewAll,\n    messages: $data.messages,\n    onReadMessages: $options.readMessages\n  }, null, 8, [\"value\", \"hidden\", \"onReadAll\", \"onViewAll\", \"messages\", \"onReadMessages\"]), _createVNode(_component_clear_tab), _createVNode(_component_screenfull), _hoisted_4, _createVNode(_component_user)])])]);\n}","map":{"version":3,"sources":["/Users/zhahn/Documents/Hahn/自考/mall/mall_cms/src/component/layout/nav-bar.vue"],"names":[],"mappings":";;;;;;;AACO,EAAA,KAAK,EAAC;;;AACJ,EAAA,KAAK,EAAC;;;AAEJ,EAAA,KAAK,EAAC;;;;;;;;;;;;;;;;uBAHf,mBAAA,CAmBM,KAnBN,EAAA,UAAA,EAmBM,CAlBJ,mBAAA,CAiBM,KAjBN,EAAA,UAAA,EAiBM,CAhBJ,YAAA,CAAc,qBAAd,CAgBI,EAfJ,mBAAA,CAcM,KAdN,EAAA,UAAA,EAcM,CAbJ,YAAA,CAUa,qBAVb,EAUa;AATX,IAAA,MAAM,EAAC,KASI;AARV,IAAA,KAAK,EAAE,KAAA,CAAA,KAQG;AAPV,IAAA,MAAM,EAAE,KAAA,CAAA,MAOE;AANV,IAAA,OAAO,EAAE,OAMC;AALV,IAAA,SAAO,EAAE,QAAA,CAAA,OAKC;AAJV,IAAA,SAAO,EAAE,QAAA,CAAA,OAIC;AAHV,IAAA,QAAQ,EAAE,KAAA,CAAA,QAGA;AAFV,IAAA,cAAY,EAAE,QAAA,CAAA;AAEJ,GAVb,E,IAAA,E,CAAA,E,2EAAA,CAaI,EAFJ,YAAA,CAAuB,oBAAvB,CAEI,EADJ,YAAA,CAAc,qBAAd,CACI,E,UAAA,EADW,YAAA,CAAa,eAAb,CACX,CAdN,CAeI,CAjBN,CAkBI,CAnBN,C","sourcesContent":["<template>\n  <div class=\"app-nav-bar\">\n    <div class=\"nav-content\">\n      <breadcrumb />\n      <div class=\"right-info\">\n        <lin-notify\n          height=\"370\"\n          :value=\"value\"\n          :hidden=\"hidden\"\n          :trigger=\"'click'\"\n          @readAll=\"readAll\"\n          @viewAll=\"viewAll\"\n          :messages=\"messages\"\n          @readMessages=\"readMessages\"\n        >\n        </lin-notify>\n        <clear-tab></clear-tab>\n        <screenfull /> <user></user>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport store from '@/store'\nimport Config from '@/config'\nimport { getToken } from '@/lin/util/token'\nimport User from './user'\nimport ClearTab from './clear-tab'\nimport Breadcrumb from './breadcrumb'\nimport Screenfull from './screen-full'\n\nexport default {\n  name: 'NavBar',\n  data() {\n    return {\n      value: 0,\n      hidden: false,\n      messages: [],\n      path: `//api.s.colorful3.com/ws/message?token=${getToken('access_token').split(' ')[1]}`,\n    }\n  },\n  created() {\n    if (Config.websocketEnable) {\n      this.$connect(this.path, { format: 'json' })\n      this.$options.sockets.onmessage = data => {\n        console.log(JSON.parse(data.data))\n        this.messages.push(JSON.parse(data.data))\n      }\n      this.$options.sockets.onerror = err => {\n        console.error(err)\n        this.$message.error('token已过期,请重新登录')\n        store.dispatch('loginOut')\n        const { origin } = window.location\n        window.location.href = origin\n      }\n    }\n  },\n  watch: {\n    messages: {\n      handler() {\n        this.value = this.messages.filter(msg => msg.is_read === false).length\n        if (this.value === 0) {\n          this.hidden = true\n        } else {\n          this.hidden = false\n        }\n      },\n      immediate: true,\n    },\n  },\n  methods: {\n    readAll() {\n      console.log('点击了readAll')\n    },\n    viewAll() {\n      console.log('点击了viewAll')\n    },\n    readMessages(msg, index) {\n      this.messages[index].is_read = true\n    },\n  },\n  components: {\n    Breadcrumb,\n    User,\n    Screenfull,\n    ClearTab,\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.app-nav-bar {\n  width: 100%;\n  height: $navbar-height;\n  display: flex;\n  align-items: center;\n  .logo.js-min-logo {\n    width: 64px;\n    font-size: 16px;\n    color: #fff;\n  }\n  .nav-content {\n    flex: 1;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding-left: 10px;\n    padding-right: $navbar-padding;\n    .right-info {\n      display: flex;\n      align-items: center;\n    }\n  }\n}\n</style>\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}