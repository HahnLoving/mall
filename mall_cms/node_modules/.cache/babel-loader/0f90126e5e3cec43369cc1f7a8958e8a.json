{"ast":null,"code":"import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\n\nvar _withScopeId = function _withScopeId(n) {\n  return _pushScopeId(\"data-v-7232456e\"), n = n(), _popScopeId(), n;\n};\n\nvar _hoisted_1 = {\n  class: \"container\"\n};\n\nvar _hoisted_2 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"div\", {\n    class: \"title\"\n  }, \"编辑分组权限\", -1\n  /* HOISTED */\n  );\n});\n\nvar _hoisted_3 = {\n  class: \"content\"\n};\nvar _hoisted_4 = {\n  class: \"content\"\n};\nvar _hoisted_5 = {\n  style: {\n    \"padding-left\": \"5px\",\n    \"margin-top\": \"30px\"\n  }\n};\n\nvar _hoisted_6 = /*#__PURE__*/_createTextVNode(\"确 定\");\n\nvar _hoisted_7 = /*#__PURE__*/_createTextVNode(\"返回\");\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_group_permissions = _resolveComponent(\"group-permissions\");\n\n  var _component_el_button = _resolveComponent(\"el-button\");\n\n  var _component_el_col = _resolveComponent(\"el-col\");\n\n  var _component_el_row = _resolveComponent(\"el-row\");\n\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_hoisted_2, _createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_el_row, null, {\n    default: _withCtx(function () {\n      return [_createVNode(_component_el_col, {\n        lg: 16,\n        md: 20,\n        sm: 24,\n        xs: 24\n      }, {\n        default: _withCtx(function () {\n          return [_createElementVNode(\"div\", _hoisted_4, [_createVNode(_component_group_permissions, {\n            id: _ctx.$route.query.id,\n            ref: \"groupPermissions\",\n            onUpdatePermissions: $setup.updatePermissions,\n            onGetCacheAuthIds: $setup.getCacheAuthIds,\n            onUpdateAllPermissions: $setup.updateAllPermissions,\n            style: {\n              \"margin-right\": \"-30px\",\n              \"margin-left\": \"-25px\",\n              \"margin-bottom\": \"-10px\"\n            }\n          }, null, 8\n          /* PROPS */\n          , [\"id\", \"onUpdatePermissions\", \"onGetCacheAuthIds\", \"onUpdateAllPermissions\"])]), _createElementVNode(\"div\", _hoisted_5, [_createVNode(_component_el_button, {\n            type: \"primary\",\n            onClick: $setup.confirmEdit\n          }, {\n            default: _withCtx(function () {\n              return [_hoisted_6];\n            }),\n            _: 1\n            /* STABLE */\n\n          }, 8\n          /* PROPS */\n          , [\"onClick\"]), _createVNode(_component_el_button, {\n            onClick: $setup.back\n          }, {\n            default: _withCtx(function () {\n              return [_hoisted_7];\n            }),\n            _: 1\n            /* STABLE */\n\n          }, 8\n          /* PROPS */\n          , [\"onClick\"])])];\n        }),\n        _: 1\n        /* STABLE */\n\n      })];\n    }),\n    _: 1\n    /* STABLE */\n\n  })])]);\n}","map":{"version":3,"sources":["/Users/zhahn/Documents/Hahn/自考/mall/mall_cms/src/view/admin/group/group-edit.vue"],"names":[],"mappings":";;;;;;;AACO,EAAA,KAAK,EAAC;;;;sBACT,mBAAA,CAA+B,KAA/B,EAA+B;AAA1B,IAAA,KAAK,EAAC;AAAoB,GAA/B,EAAmB,QAAnB,EAAyB,CAAA;AAAA;AAAzB,G;;;;AACK,EAAA,KAAK,EAAC;;;AAGA,EAAA,KAAK,EAAC;;;AAWN,EAAA,KAA0C,EAA1C;AAAA,oBAAA,KAAA;AAAA,kBAAA;AAAA;;;+CAC4C,K;;+CACtB,I;;;;;;;;;;;uBAlBnC,mBAAA,CAuBM,KAvBN,EAAA,UAAA,EAuBM,CAtBJ,UAsBI,EArBJ,mBAAA,CAoBM,KApBN,EAAA,UAAA,EAoBM,CAnBJ,YAAA,CAkBS,iBAlBT,EAkBS,IAlBT,EAkBS;sBAjBP;AAAA,aAgBS,CAhBT,YAAA,CAgBS,iBAhBT,EAgBS;AAhBA,QAAA,EAAE,EAAE,EAgBJ;AAhBS,QAAA,EAAE,EAAE,EAgBb;AAhBkB,QAAA,EAAE,EAAE,EAgBtB;AAhB2B,QAAA,EAAE,EAAE;AAgB/B,OAhBT,E;0BACE;AAAA,iBAUM,CAVN,mBAAA,CAUM,KAVN,EAAA,UAAA,EAUM,CATJ,YAAA,CAQoB,4BARpB,EAQoB;AAPjB,YAAA,EAAE,EAAE,IAAA,CAAA,MAAA,CAAO,KAAP,CAAa,EAOA;AANlB,YAAA,GAAG,EAAC,kBAMc;AALjB,YAAA,mBAAiB,EAAE,MAAA,CAAA,iBAKF;AAJjB,YAAA,iBAAe,EAAE,MAAA,CAAA,eAIA;AAHjB,YAAA,sBAAoB,EAAE,MAAA,CAAA,oBAGL;AAFlB,YAAA,KAAiE,EAAjE;AAAA,8BAAA,OAAA;AAAA,6BAAA,OAAA;AAAA,+BAAA;AAAA;AAEkB,WARpB,E,IAAA,E;;AAAA,Y,4EAAA,CASI,CAVN,CAUM,EACN,mBAAA,CAGM,KAHN,EAAA,UAAA,EAGM,CAFJ,YAAA,CAA8D,oBAA9D,EAA8D;AAAnD,YAAA,IAAI,EAAC,SAA8C;AAAnC,YAAA,OAAK,EAAE,MAAA,CAAA;AAA4B,WAA9D,E;8BAA+C;AAAA,qBAAG,C,UAAA,CAAH;AAAA,a;;;;WAA/C,E;;AAAA,Y,WAAA,CAEI,EADJ,YAAA,CAAuC,oBAAvC,EAAuC;AAA3B,YAAA,OAAK,EAAE,MAAA,CAAA;AAAoB,WAAvC,EAAuB;8BAAE;AAAA,qBAAE,C,UAAA,CAAF;AAAA,a,CAAF;;;;AAAA,WAAvB,E;;AAAA,Y,WAAA,CACI,CAHN,CADM,CAVN;AAAA,S;;;;OADF,CAgBS,CAhBT;AAAA,K,CAiBO;;;;AAAA,GAlBT,CAmBI,CApBN,CAqBI,CAvBN,C","sourcesContent":["<template>\n  <div class=\"container\">\n    <div class=\"title\">编辑分组权限</div>\n    <div class=\"content\">\n      <el-row>\n        <el-col :lg=\"16\" :md=\"20\" :sm=\"24\" :xs=\"24\">\n          <div class=\"content\">\n            <group-permissions\n              :id=\"$route.query.id\"\n              ref=\"groupPermissions\"\n              @updatePermissions=\"updatePermissions\"\n              @getCacheAuthIds=\"getCacheAuthIds\"\n              @updateAllPermissions=\"updateAllPermissions\"\n              style=\"margin-right:-30px;margin-left:-25px;margin-bottom:-10px;\"\n            >\n            </group-permissions>\n          </div>\n          <div style=\"padding-left:5px;margin-top: 30px;\">\n            <el-button type=\"primary\" @click=\"confirmEdit\">确 定</el-button>\n            <el-button @click=\"back\">返回</el-button>\n          </div>\n        </el-col>\n      </el-row>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref } from 'vue'\nimport { useRoute, useRouter } from 'vue-router'\nimport { ElMessage } from 'element-plus'\nimport AdminModel from '@/lin/model/admin'\nimport GroupPermissions from './group-permission'\n\nexport default {\n  components: {\n    GroupPermissions,\n  },\n  setup() {\n    const route = useRoute()\n    const router = useRouter()\n    // originally data properties\n    const permissions = ref([])\n    const allPermissions = ref([])\n    const cachePermissions = ref([])\n\n    /**\n     * 编辑后的最终权限\n     */\n    const updatePermissions = picked => {\n      permissions.value = picked\n    }\n\n    /**\n     * 全部权限\n     */\n    const updateAllPermissions = all => {\n      allPermissions.value = all\n    }\n\n    /**\n     * 页面打开时候，记录当前分组所拥有的全部权限\n     */\n    const getCacheAuthIds = ids => {\n      cachePermissions.value = ids\n    }\n\n    /**\n     * 确认修改\n     */\n    const confirmEdit = async () => {\n      let addRes = 0\n      let delRes = 0\n      const groupId = parseInt(route.query.id, 10)\n      // 判断是否更改了分组权限\n      if (permissions.value.sort().toString() !== cachePermissions.value.sort().toString()) {\n        const deletePermissions = cachePermissions.value\n          .concat(permissions.value)\n          .filter(v => !permissions.value.includes(v))\n        const addPermissions = cachePermissions.value\n          .concat(permissions.value)\n          .filter(v => !cachePermissions.value.includes(v))\n\n        if (addPermissions.length > 0) {\n          addRes = await AdminModel.dispatchPermissions(groupId, addPermissions)\n        }\n        if (deletePermissions.length > 0) {\n          delRes = await AdminModel.removePermissions(groupId, deletePermissions)\n        }\n        if (addRes.code < window.MAX_SUCCESS_CODE || delRes.code < window.MAX_SUCCESS_CODE) {\n          ElMessage.success('权限修改成功')\n        }\n      }\n    }\n\n    /**\n     * 返回\n     */\n    const back = () => {\n      router.go(-1)\n    }\n\n    return {\n      back,\n      permissions,\n      confirmEdit,\n      allPermissions,\n      getCacheAuthIds,\n      cachePermissions,\n      updatePermissions,\n      updateAllPermissions,\n    }\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.container {\n  .title {\n    height: 59px;\n    line-height: 59px;\n    color: $parent-title-color;\n    font-size: 16px;\n    font-weight: 500;\n    text-indent: 40px;\n    border-bottom: 1px solid #dae1ec;\n  }\n\n  .content {\n    margin-top: 10px;\n    padding-left: 33px;\n    padding-right: 40px;\n  }\n\n  .submit {\n    float: left;\n  }\n}\n</style>\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}