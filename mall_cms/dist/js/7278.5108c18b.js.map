{"version":3,"file":"js/7278.5108c18b.js","mappings":"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","sources":["webpack://lin-cms-vue/./src/model/coupon.js","webpack://lin-cms-vue/./src/view/coupon/CouponEdit.vue","webpack://lin-cms-vue/./src/view/coupon/CouponEdit.vue?463f"],"sourcesContent":["import { post, get, put, _delete } from '@/lin/plugin/axios'\n\nclass Coupon {\n  static types = ['满减券', '折扣券', '无门槛券', '满金额折扣券']\n\n  static async addCoupon(data) {\n    const res = await post('v1/coupon', data)\n    return res\n  }\n\n  static async getCoupon(id) {\n    const res = await get(`v1/coupon/${id}`)\n    return res\n  }\n\n  static async editCoupon(id, data) {\n    const res = await put(`v1/coupon/${id}`, data)\n    return res\n  }\n\n  static async deleteCoupon(id) {\n    const res = await _delete(`v1/coupon/${id}`)\n    return res\n  }\n\n  static async addCouponTemplate(data) {\n    const res = await post('v1/coupon/template', data)\n    return res\n  }\n\n  static async editCouponTemplate(id, data) {\n    const res = await put(`v1/coupon/template/${id}`, data)\n    return res\n  }\n\n  static async getCouponTemplate(id) {\n    const res = await get(`v1/coupon/template/${id}`)\n    return res\n  }\n\n  static async deleteCouponTemplate(id) {\n    const res = await _delete(`v1/coupon/template/${id}`)\n    return res\n  }\n\n  static async getCouponTemplates() {\n    const res = await get('v1/coupon/templates')\n    return res\n  }\n\n  static async getListByActivityId(id) {\n    const res = await get(`v1/coupon/list?id=${id}`)\n    return res\n  }\n}\n\nexport default Coupon\n","<template>\n  <div class=\"container\">\n    <div class=\"title\">\n      <span>{{ isCreate ? '创建优惠卷' : '更新优惠卷' }}</span>\n      <span class=\"back\" @click=\"back\"> <i class=\"iconfont icon-fanhui\"></i> 返回 </span>\n    </div>\n    <div class=\"wrap\">\n      <el-row>\n        <el-col :lg=\"16\" :md=\"20\" :sm=\"24\" :xs=\"24\">\n          <el-form :model=\"form\" status-icon ref=\"form\" label-width=\"100px\" @submit.native.prevent>\n            <el-form-item label=\"标题\" prop=\"title\">\n              <el-input size=\"medium\" v-model=\"form.title\" placeholder=\"请填写优惠卷标题\"></el-input>\n            </el-form-item>\n\n            <el-form-item label=\"满减额\" prop=\"full_money\">\n              <el-input-number v-model=\"form.full_money\" :precision=\"2\" :step=\"1\"></el-input-number>\n            </el-form-item>\n\n            <el-form-item label=\"优惠额\" prop=\"minus\">\n              <el-input-number v-model=\"form.minus\" :precision=\"2\" :step=\"1\"></el-input-number>\n            </el-form-item>\n\n            <el-form-item label=\"折扣\" prop=\"rate\">\n              <el-input-number v-model=\"form.rate\" :precision=\"2\" :step=\"0.1\" :max=\"1\"></el-input-number>\n            </el-form-item>\n\n            <el-form-item label=\"类型\" prop=\"type\">\n              <!-- <el-input size=\"medium\" v-model=\"form.type\" placeholder=\"请填写优惠卷类型\"></el-input> -->\n              <el-select v-model=\"form.type\" placeholder=\"请填写类型\">\n                <el-option v-for=\"(item, index) in types\" :key=\"item\" :label=\"item\" :value=\"index + 1\"></el-option>\n              </el-select>\n            </el-form-item>\n\n            <el-form-item label=\"时间\">\n              <el-date-picker\n                v-model=\"range\"\n                type=\"daterange\"\n                align=\"right\"\n                unlink-panels\n                range-separator=\"至\"\n                start-placeholder=\"开始日期\"\n                end-placeholder=\"结束日期\"\n                :picker-options=\"pickerOptions\"\n              ></el-date-picker>\n            </el-form-item>\n\n            <el-form-item label=\"描述\" prop=\"description\">\n              <el-input size=\"medium\" v-model=\"form.description\" placeholder=\"请填写优惠卷描述\"></el-input>\n            </el-form-item>\n\n            <el-form-item class=\"submit\">\n              <el-button\n                v-permission=\"{ permission: ['创建优惠卷', '更新优惠卷'], type: 'disabled' }\"\n                type=\"primary\"\n                @click=\"submitForm('form')\"\n                >保 存</el-button\n              >\n              <!-- <el-button @click=\"resetForm('form')\">重 置</el-button> -->\n            </el-form-item>\n          </el-form>\n        </el-col>\n      </el-row>\n    </div>\n  </div>\n</template>\n\n<script>\nimport dayjs from 'dayjs'\nimport Coupon from '@/model/coupon'\n\nexport default {\n  props: {\n    isCreate: {\n      type: Boolean,\n      default: false,\n    },\n    couponId: {\n      type: String,\n      default: null,\n    },\n    activityId: {\n      type: String,\n      default: null,\n    },\n    templateData: {\n      type: Object,\n      default: null,\n    },\n  },\n  data() {\n    return {\n      form: {\n        name: '',\n        title: '',\n        full_money: null,\n        minus: null,\n        rate: null,\n        type: null,\n        activity_id: null,\n      },\n      types: [],\n      range: '',\n      pickerOptions: {\n        shortcuts: [\n          {\n            text: '最近一周',\n            onClick(picker) {\n              const end = new Date()\n              const start = new Date()\n              start.setTime(start.getTime() - 3600 * 1000 * 24 * 7)\n              picker.$emit('pick', [start, end])\n            },\n          },\n          {\n            text: '最近一个月',\n            onClick(picker) {\n              const end = new Date()\n              const start = new Date()\n              start.setTime(start.getTime() - 3600 * 1000 * 24 * 30)\n              picker.$emit('pick', [start, end])\n            },\n          },\n          {\n            text: '最近三个月',\n            onClick(picker) {\n              const end = new Date()\n              const start = new Date()\n              start.setTime(start.getTime() - 3600 * 1000 * 24 * 90)\n              picker.$emit('pick', [start, end])\n            },\n          },\n        ],\n      },\n    }\n  },\n  async mounted() {\n    this.types = Coupon.types\n    if (!this.isCreate) {\n      const res = await Coupon.getCoupon(this.couponId)\n      this.form = res\n      const end = new Date(res.end_time)\n      const start = new Date(res.start_time)\n      this.range = [start, end]\n    } else {\n      this.form = this.templateData\n    }\n  },\n  methods: {\n    async submitForm(formName) {\n      this.form.remark = \"全场无门槛立减\"\n      this.form.whole_store = 1\n      this.form.activity_id = this.activityId\n      try {\n        const postData = { ...this.form }\n        if (postData.rate === 0) {\n          postData.rate = null\n        }\n        if (postData.minus === 0) {\n          postData.minus = null\n        }\n        if (postData.full_money === 0) {\n          postData.full_money = null\n        }\n        postData.start_time = this.dateFormat(this.range[0])\n        postData.end_time = this.dateFormat(this.range[1])\n        let res\n        if (this.isCreate) {\n          res = await Coupon.addCoupon(postData)\n        } else {\n          res = await Coupon.editCoupon(\n            this.couponId,\n            // eslint-disable-next-line\n            postData,\n          )\n        }\n        if (res.code < window.MAX_SUCCESS_CODE) {\n          this.$message.success(`${res.message}`)\n          this.resetForm(formName)\n          this.$confirm('是否返回上一页?', '提示', {\n            confirmButtonText: '是',\n            cancelButtonText: '否',\n            type: 'info',\n          }).then(async () => {\n            this.$emit('editClose')\n          })\n        }\n      } catch (error) {\n        console.error(error)\n      }\n    },\n    // 重置表单\n    resetForm(formName) {\n      this.$refs[formName].resetFields()\n    },\n    back() {\n      this.$emit('editClose')\n    },\n    dateFormat(val) {\n      return dayjs(val).format('YYYY-MM-DD HH:mm:ss')\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.el-divider--horizontal {\n  margin: 0;\n}\n\n.container {\n  .title {\n    height: 59px;\n    line-height: 59px;\n    color: $parent-title-color;\n    font-size: 16px;\n    font-weight: 500;\n    text-indent: 40px;\n\n    .back {\n      float: right;\n      margin-right: 40px;\n      cursor: pointer;\n    }\n  }\n\n  .wrap {\n    padding: 20px;\n  }\n\n  .submit {\n    float: left;\n  }\n}\n\n.my-autocomplete {\n  li {\n    line-height: normal;\n    padding: 7px;\n    display: inline-flex;\n    align-content: space-around;\n    .name {\n      text-overflow: ellipsis;\n      overflow: hidden;\n    }\n    .id {\n      margin-right: 15px;\n      font-size: 12px;\n      color: #b4b4b4;\n    }\n\n    .highlighted .addr {\n      color: #ddd;\n    }\n  }\n}\n</style>\n","import { render } from \"./CouponEdit.vue?vue&type=template&id=77974340&scoped=true\"\nimport script from \"./CouponEdit.vue?vue&type=script&lang=js\"\nexport * from \"./CouponEdit.vue?vue&type=script&lang=js\"\n\nimport \"./CouponEdit.vue?vue&type=style&index=0&id=77974340&lang=scss&scoped=true\"\n\nimport exportComponent from \"/Users/zhahn/Documents/Hahn/自考/mall/mall_cms/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-77974340\"]])\n\nexport default __exports__"],"names":["Coupon","data","post","res","id","get","put","_delete","class","isCreate","back","lg","md","sm","xs","model","form","ref","label","prop","size","title","placeholder","full_money","precision","step","minus","rate","max","type","types","item","index","key","value","range","align","pickerOptions","description","submitForm","props","Boolean","default","couponId","String","activityId","templateData","Object","name","activity_id","shortcuts","text","onClick","picker","end","Date","start","setTime","getTime","$emit","mounted","end_time","start_time","methods","formName","remark","whole_store","postData","dateFormat","code","window","MAX_SUCCESS_CODE","$message","success","message","resetForm","$confirm","confirmButtonText","cancelButtonText","then","console","error","this","$refs","resetFields","val","format","__exports__","render"],"sourceRoot":""}