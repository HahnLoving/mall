"use strict";(self["webpackChunklin_cms_vue"]=self["webpackChunklin_cms_vue"]||[]).push([[8840,370,9646,4605],{29364:function(e,n,t){t.r(n),t.d(n,{default:function(){return v}});var r=t(66252),a=t(58061),i=function(e){return(0,r.dD)("data-v-5054497b"),e=e(),(0,r.Cn)(),e},o={key:0,class:"container"},s=i((function(){return(0,r._)("div",{class:"header"},[(0,r._)("div",{class:"title"},"Banner列表")],-1)})),u=(0,r.Uk)("查看"),l=(0,r.Uk)("删除"),c={class:"pagination"};function d(e,n,t,i,d,g){var p=(0,r.up)("el-table-column"),m=(0,r.up)("el-image"),h=(0,r.up)("el-button"),f=(0,r.up)("el-table"),w=(0,r.up)("el-pagination"),v=(0,r.up)("banner-with-items"),C=(0,r.Q2)("permission"),b=(0,r.Q2)("loading");return d.showDetail?((0,r.wg)(),(0,r.j4)(v,{key:1,onDetailClose:g.detailClose,bannerId:d.detailBannerId},null,8,["onDetailClose","bannerId"])):((0,r.wg)(),(0,r.iD)("div",o,[s,(0,r.wy)((0,r.Wm)(f,{stripe:"",data:d.tableData},{default:(0,r.w5)((function(){return[(0,r.Wm)(p,{prop:"id",label:"id",width:"100"}),(0,r.Wm)(p,{prop:"img",label:"图片",width:"200"},{default:(0,r.w5)((function(e){return[(0,r.Wm)(m,{src:e.row.img,"preview-src-list":d.imgSrcList,style:{"max-height":"50px","max-width":"100px"}},null,8,["src","preview-src-list"])]})),_:1}),(0,r.Wm)(p,{prop:"name",label:"名称",width:"150"}),(0,r.Wm)(p,{prop:"description",label:"描述","min-width":"200","show-overflow-tooltip":!0}),(0,r.Wm)(p,{fixed:"right",width:"150",label:"操作"},{default:(0,r.w5)((function(e){return[(0,r.Wm)(h,{onClick:(0,a.iM)((function(n){return g.handleDetail(e.row)}),["prevent"]),type:"primary",plain:"",size:"mini"},{default:(0,r.w5)((function(){return[u]})),_:2},1032,["onClick"]),(0,r.wy)((0,r.Wm)(h,{onClick:(0,a.iM)((function(n){return g.handleDelete(e.row)}),["prevent"]),type:"danger",plain:"",size:"mini"},{default:(0,r.w5)((function(){return[l]})),_:2},1032,["onClick"]),[[C,{permission:"删除Banner",type:"disabled"}]])]})),_:1})]})),_:1},8,["data"]),[[b,e.loading]]),(0,r._)("div",c,[d.refreshPagination?((0,r.wg)(),(0,r.j4)(w,{key:0,onCurrentChange:g.handleCurrentChange,background:!0,"page-size":d.pageCount,"current-page":d.currentPage,layout:"prev, pager, next, jumper",total:d.totalNums},null,8,["onCurrentChange","page-size","current-page","total"])):(0,r.kq)("",!0)])]))}var g=t(48534),p=(t(41539),t(54747),t(35666),t(78836)),m=t(26251),h={components:{BannerWithItems:m["default"]},data:function(){return{showDetail:!1,tableData:[],imgSrcList:[],totalNums:0,currentPage:1,pageCount:10,refreshPagination:!0,detailBannerId:0}},created:function(){var e=this;return(0,g.Z)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.loading=!0,e.getBanners(),e.loading=!1;case 3:case"end":return n.stop()}}),n)})))()},methods:{getBanners:function(){var e=this;return(0,g.Z)(regeneratorRuntime.mark((function n(){var t,r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t=e.currentPage-1,r=e.pageCount,n.next=4,p["default"].getBanners(t,r);case 4:a=n.sent,e.tableData=a.items,e.totalNums=a.total,e.initImgSrcList();case 8:case"end":return n.stop()}}),n)})))()},handleCurrentChange:function(e){var n=this;return(0,g.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n.imgSrcList=[],n.currentPage=e,n.loading=!0,n.getBanners(),n.loading=!1;case 5:case"end":return t.stop()}}),t)})))()},initImgSrcList:function(){var e=this;this.tableData.forEach((function(n){n.img&&e.imgSrcList.push(n.img)}))},handleDetail:function(e){this.showDetail=!0,this.detailBannerId=e.id},handleDelete:function(e){var n,t=this;this.$confirm("此操作将永久删除该banner，是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((0,g.Z)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,t.loading=!0,r.next=4,p["default"].deleteBanner(e.id);case 4:n=r.sent,r.next=11;break;case 7:r.prev=7,r.t0=r["catch"](0),t.loading=!1,console.log(r.t0);case 11:n.code<window.MAX_SUCCESS_CODE?(t.loading=!1,t.totalNums%t.pageCount===1&&1!==t.currentPage&&t.currentPage--,t.getBanners(),t.$message({type:"success",message:"".concat(n.message)})):(t.loading=!1,t.$message.error("".concat(n.message)));case 12:case"end":return r.stop()}}),r,null,[[0,7]])}))))},rowClick:function(){},detailClose:function(){this.showDetail=!1,this.getBanners()}}},f=t(83744);const w=(0,f.Z)(h,[["render",d],["__scopeId","data-v-5054497b"]]);var v=w}}]);
//# sourceMappingURL=8840.fb6e4fa4.js.map