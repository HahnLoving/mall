"use strict";(self["webpackChunklin_cms_vue"]=self["webpackChunklin_cms_vue"]||[]).push([[7638,3602,7540],{63602:function(e,t,r){r.r(t);var n=r(48534),a=r(13087),u=r(62833),i=(r(35666),r(12109)),o=function(){function e(){(0,a.Z)(this,e)}return(0,u.Z)(e,null,[{key:"addCategory",value:function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.post)("v1/category",t);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getCategory",value:function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.get)("v1/category/".concat(t));case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"editCategory",value:function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.put)("v1/category/".concat(t),r);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"deleteCategory",value:function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i._delete)("v1/category/".concat(t));case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getCategories",value:function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(){var t,r,n,a,u=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:0,r=u.length>1&&void 0!==u[1]?u[1]:10,n=u.length>2&&void 0!==u[2]?u[2]:1,e.next=5,(0,i.get)("v1/category/page",{page:t,count:r,root:n});case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getSubCategories",value:function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(){var t,r,n,a,u=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:0,r=u.length>1&&void 0!==u[1]?u[1]:10,n=u.length>2&&void 0!==u[2]?u[2]:1,e.next=5,(0,i.get)("v1/category/sub-page",{page:t,count:r,id:n});case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getList",value:function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.get)("v1/category/list");case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}]),e}();t["default"]=o},97540:function(e,t,r){r.r(t);var n=r(48534),a=r(13087),u=r(62833),i=(r(35666),r(12109)),o=function(){function e(){(0,a.Z)(this,e)}return(0,u.Z)(e,null,[{key:"addGridCategory",value:function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.post)("v1/grid-category",t);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getGridCategory",value:function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.get)("v1/grid-category/".concat(t));case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"editGridCategory",value:function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.put)("v1/grid-category/".concat(t),r);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"deleteGridCategory",value:function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i._delete)("v1/grid-category/".concat(t));case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getGridCategories",value:function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.get)("v1/grid-category/list");case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}]),e}();t["default"]=o},47638:function(e,t,r){r.r(t),r.d(t,{default:function(){return k}});r(68309);var n=r(66252),a=r(56612),u=r(58061),i={style:{"margin-top":"-25px"}},o={class:"dialog-title"},s={class:"id"},c={class:"name"},l={slot:"footer",class:"dialog-footer",style:{"padding-left":"5px"}},d=(0,n.Uk)("确 定");function p(e,t,r,p,m,g){var f=(0,n.up)("el-input"),v=(0,n.up)("el-form-item"),h=(0,n.up)("el-autocomplete"),y=(0,n.up)("upload-imgs"),w=(0,n.up)("el-form"),x=(0,n.up)("el-button"),k=(0,n.Q2)("permission");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("div",i,[(0,n._)("div",o,[(0,n._)("span",null,(0,a.zw)(r.isCreate?"创建六宫格":"更新六宫格"),1)]),(0,n.Wm)(w,{model:m.form,"status-icon":"",ref:"form","label-width":"100px",onSubmit:t[4]||(t[4]=(0,u.iM)((function(){}),["prevent"]))},{default:(0,n.w5)((function(){return[(0,n.Wm)(v,{label:"标题",prop:"title"},{default:(0,n.w5)((function(){return[(0,n.Wm)(f,{size:"medium",modelValue:m.form.title,"onUpdate:modelValue":t[0]||(t[0]=function(e){return m.form.title=e}),placeholder:"请填写宫格标题"},null,8,["modelValue"])]})),_:1}),(0,n.Wm)(v,{label:"名称",prop:"name"},{default:(0,n.w5)((function(){return[(0,n.Wm)(f,{size:"medium",modelValue:m.form.name,"onUpdate:modelValue":t[1]||(t[1]=function(e){return m.form.name=e}),placeholder:"请填写宫格名"},null,8,["modelValue"])]})),_:1}),(0,n.Wm)(v,{label:"排序",prop:"index"},{default:(0,n.w5)((function(){return[(0,n.Wm)(f,{size:"medium",modelValue:m.form.index,"onUpdate:modelValue":t[2]||(t[2]=function(e){return m.form.index=e}),placeholder:"请填写分类排序"},null,8,["modelValue"])]})),_:1}),(0,n.Wm)(v,{label:"分类",prop:"category_id"},{default:(0,n.w5)((function(){return[(0,n.Wm)(h,{onFocus:g.loadSuggestions,"popper-class":"my-autocomplete",class:"inline-input",modelValue:m.state,"onUpdate:modelValue":t[3]||(t[3]=function(e){return m.state=e}),"fetch-suggestions":g.querySearch,placeholder:"请填写所属分类",onSelect:g.handleSelect},{default:(0,n.w5)((function(e){var t=e.item;return[(0,n._)("span",s,"id： "+(0,a.zw)(t.id),1),(0,n._)("span",c," 名称："+(0,a.zw)(t.name),1)]})),_:1},8,["onFocus","modelValue","fetch-suggestions","onSelect"])]})),_:1}),(0,n.Wm)(v,{label:"图片",prop:"img"},{default:(0,n.w5)((function(){return[(0,n.Wm)(y,{ref:"uploadEle","max-num":m.maxNum,value:m.initData},null,8,["max-num","value"])]})),_:1})]})),_:1},8,["model"])]),(0,n._)("div",l,[(0,n.wy)((0,n.Wm)(x,{type:"primary",onClick:g.submitForm},{default:(0,n.w5)((function(){return[d]})),_:1},8,["onClick"]),[[k,{permission:"更新六宫格",type:"disabled"}]])])],64)}var m=r(95082),g=r(48534),f=(r(35666),r(9653),r(57327),r(41539),r(97540)),v=r(63602),h=r(5892),y={name:"grid-category-edit",components:{UploadImgs:h["default"]},props:{dialogFormVisible:{type:Boolean,default:!1},isCreate:{type:Boolean,default:!1},gridCategoryId:{type:Number,default:0}},computed:{visible:{get:function(){return this.dialogFormVisible},set:function(){}}},data:function(){return{state:"",suggestions:[],display:!0,initData:[],maxNum:1,form:{name:"",title:"",category_id:null,root_category_id:null}}},watch:{display:function(e){this.form.online=e?1:0}},mounted:function(){var e=this;return(0,g.Z)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.isCreate){t.next=6;break}return t.next=3,f["default"].getGridCategory(e.gridCategoryId);case 3:r=t.sent,e.form=r,e.initData=[{display:r.img}];case 6:e.loadSuggestions();case 7:case"end":return t.stop()}}),t)})))()},methods:{submitForm:function(){var e=this;return(0,g.Z)(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getValue();case 2:if(r=(0,m.Z)({},e.form),!e.isCreate){t.next=9;break}return t.next=6,f["default"].addGridCategory(r);case 6:n=t.sent,t.next=12;break;case 9:return t.next=11,f["default"].editGridCategory(e.gridCategoryId,r);case 11:n=t.sent;case 12:n.code<window.MAX_SUCCESS_CODE&&(e.$message.success("".concat(n.message)),e.$emit("dialogClose"));case 13:case"end":return t.stop()}}),t)})))()},querySearch:function(e,t){var r=this.suggestions;t(r)},handleSelect:function(e){this.state=e.name,this.form.category_id=e.id},getValue:function(){var e=this;return(0,g.Z)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.uploadEle.getValue();case 2:r=t.sent,r&&r.length>0&&(e.form.img=r[0].display);case 4:case"end":return t.stop()}}),t)})))()},loadSuggestions:function(){var e=this;return(0,g.Z)(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,v["default"].getList();case 3:e.suggestions=t.sent,0===e.suggestions.length&&e.$message.error("未找到宫格，请先添加宫格"),t.next=11;break;case 7:t.prev=7,t.t0=t["catch"](0),e.$message.error("获取宫格信息失败"),console.error(t.t0);case 11:r=e.getInlineId(),n=e.suggestions.filter((function(e){return e.id===r})),n.length>0&&(e.state=n[0].name);case 14:case"end":return t.stop()}}),t,null,[[0,7]])})))()},getInlineId:function(){return this.form.category_id?this.form.category_id:this.form.root_category_id?this.form.root_category_id:null},resetForm:function(e){this.$refs[e].resetFields()},handleClose:function(e){e(),this.$emit("dialogClose")}}},w=r(83744);const x=(0,w.Z)(y,[["render",p],["__scopeId","data-v-5066753e"]]);var k=x}}]);
//# sourceMappingURL=7638.69d1e164.js.map