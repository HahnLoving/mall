"use strict";(self["webpackChunklin_cms_vue"]=self["webpackChunklin_cms_vue"]||[]).push([[7972,1301],{41301:function(e,n,r){r.r(n),r.d(n,{default:function(){return s}});var t=r(48534),u=r(13087),a=r(62833),i=(r(35666),r(12109)),s=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;(0,u.Z)(this,e),this.uPage=n,this.uCount=r,this.lPage=t,this.gCount=a}return(0,a.Z)(e,[{key:"increaseUPage",value:function(){var e=(0,t.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.uPage+=1;case 1:case"end":return e.stop()}}),e,this)})));function n(){return e.apply(this,arguments)}return n}()},{key:"increaseGPage",value:function(){var e=(0,t.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.lPage+=1;case 1:case"end":return e.stop()}}),e,this)})));function n(){return e.apply(this,arguments)}return n}()},{key:"decreaseUPage",value:function(){var e=(0,t.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.uPage-=1,this.uPage<0&&(this.uPage=0);case 2:case"end":return e.stop()}}),e,this)})));function n(){return e.apply(this,arguments)}return n}()},{key:"decreaseGPage",value:function(){var e=(0,t.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.lPage-=1,this.lPage<0&&(this.lPage=0);case 2:case"end":return e.stop()}}),e,this)})));function n(){return e.apply(this,arguments)}return n}()},{key:"nextUsersPage",value:function(){var e=(0,t.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.increaseUPage();case 2:return e.abrupt("return",this.getAdminUsers({}));case 3:case"end":return e.stop()}}),e,this)})));function n(){return e.apply(this,arguments)}return n}()},{key:"preUsersPage",value:function(){var e=(0,t.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.decreaseUPage();case 2:return e.abrupt("return",this.getAdminUsers({}));case 3:case"end":return e.stop()}}),e,this)})));function n(){return e.apply(this,arguments)}return n}()},{key:"getGroupsWithPermissions",value:function(){var e=(0,t.Z)(regeneratorRuntime.mark((function e(n){var r,t,u,a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=n.count,t=void 0===r?this.uCount:r,u=n.page,a=void 0===u?this.uPage:u,e.next=3,(0,i.get)("cms/admin/groups",{count:t,page:a});case 3:return s=e.sent,e.abrupt("return",s);case 5:case"end":return e.stop()}}),e,this)})));function n(n){return e.apply(this,arguments)}return n}()},{key:"nextGroupsPage",value:function(){var e=(0,t.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.increaseGPage();case 2:return e.abrupt("return",this.getGroupsWithPermissions({}));case 3:case"end":return e.stop()}}),e,this)})));function n(){return e.apply(this,arguments)}return n}()},{key:"preGroupsPage",value:function(){var e=(0,t.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.decreaseGPage();case 2:return e.abrupt("return",this.getGroupsWithPermissions({}));case 3:case"end":return e.stop()}}),e,this)})));function n(){return e.apply(this,arguments)}return n}()}],[{key:"getAllPermissions",value:function(){return(0,i.get)("cms/admin/permission")}},{key:"getAdminUsers",value:function(){var e=(0,t.Z)(regeneratorRuntime.mark((function e(n){var r,t,u,a,s,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=n.groupId,t=n.count,u=void 0===t?this.uCount:t,a=n.page,s=void 0===a?this.uPage:a,!r){e.next=7;break}return e.next=4,(0,i.get)("cms/admin/users",{count:u,page:s,group_id:r});case 4:o=e.sent,e.next=10;break;case 7:return e.next=9,(0,i.get)("cms/admin/users",{count:u,page:s});case 9:o=e.sent;case 10:return e.abrupt("return",o);case 11:case"end":return e.stop()}}),e,this)})));function n(n){return e.apply(this,arguments)}return n}()},{key:"getAllGroups",value:function(){var e=(0,t.Z)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.get)("cms/admin/group/all");case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));function n(){return e.apply(this,arguments)}return n}()},{key:"getOneGroup",value:function(){var e=(0,t.Z)(regeneratorRuntime.mark((function e(n){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.get)("cms/admin/group/".concat(n));case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));function n(n){return e.apply(this,arguments)}return n}()},{key:"createOneGroup",value:function(){var e=(0,t.Z)(regeneratorRuntime.mark((function e(n,r,t){var u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.post)("cms/admin/group",{name:n,info:r,permission_ids:t});case 2:return u=e.sent,e.abrupt("return",u);case 4:case"end":return e.stop()}}),e)})));function n(n,r,t){return e.apply(this,arguments)}return n}()},{key:"updateOneGroup",value:function(){var e=(0,t.Z)(regeneratorRuntime.mark((function e(n,r,t){var u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.put)("cms/admin/group/".concat(t),{name:n,info:r});case 2:return u=e.sent,e.abrupt("return",u);case 4:case"end":return e.stop()}}),e)})));function n(n,r,t){return e.apply(this,arguments)}return n}()},{key:"deleteOneGroup",value:function(){var e=(0,t.Z)(regeneratorRuntime.mark((function e(n){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i._delete)("cms/admin/group/".concat(n));case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));function n(n){return e.apply(this,arguments)}return n}()},{key:"deleteOneUser",value:function(){var e=(0,t.Z)(regeneratorRuntime.mark((function e(n){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i._delete)("cms/admin/user/".concat(n));case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));function n(n){return e.apply(this,arguments)}return n}()},{key:"updateOneUser",value:function(){var e=(0,t.Z)(regeneratorRuntime.mark((function e(n,r,t){var u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.put)("cms/admin/user/".concat(t),{email:n,group_ids:r});case 2:return u=e.sent,e.abrupt("return",u);case 4:case"end":return e.stop()}}),e)})));function n(n,r,t){return e.apply(this,arguments)}return n}()},{key:"dispatchPermissions",value:function(){var e=(0,t.Z)(regeneratorRuntime.mark((function e(n,r){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.post)("cms/admin/permission/dispatch/batch",{group_id:n,permission_ids:r});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));function n(n,r){return e.apply(this,arguments)}return n}()},{key:"changePassword",value:function(){var e=(0,t.Z)(regeneratorRuntime.mark((function e(n,r,t){var u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.put)("cms/admin/user/".concat(t,"/password"),{new_password:n,confirm_password:r});case 2:return u=e.sent,e.abrupt("return",u);case 4:case"end":return e.stop()}}),e)})));function n(n,r,t){return e.apply(this,arguments)}return n}()},{key:"removePermissions",value:function(){var e=(0,t.Z)(regeneratorRuntime.mark((function e(n,r){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.post)("cms/admin/permission/remove",{group_id:n,permission_ids:r});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));function n(n,r){return e.apply(this,arguments)}return n}()}]),e}()},37972:function(e,n,r){r.r(n),r.d(n,{default:function(){return w}});r(26699),r(32023),r(68309);var t=r(66252),u=r(56612),a={class:"container"},i={class:"group"},s={class:"label"},o={class:"details"},c={class:"module-box"},l={class:"permissions-ul"};function p(e,n,r,p,m,v){var f=(0,t.up)("el-checkbox"),h=(0,t.up)("el-checkbox-group"),d=(0,t.Q2)("loading");return(0,t.wy)(((0,t.wg)(),(0,t.iD)("div",a,[(0,t._)("div",i,[(0,t._)("div",s,[(0,t._)("label",null,(0,u.zw)(r.title),1)]),(0,t._)("div",o,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(p.allPermissions,(function(e,r){return(0,t.wg)(),(0,t.iD)("div",{class:"permissions-box",key:r},[(0,t.Wm)(h,{modelValue:p.permissionModuleNames,"onUpdate:modelValue":n[0]||(n[0]=function(e){return p.permissionModuleNames=e})},{default:(0,t.w5)((function(){return[(0,t._)("div",c,[(0,t.Wm)(f,{onChange:function(n){return p.moduleCheck(n,e,r)},class:"module",label:r,indeterminate:p.halfPermissions.includes(r)},null,8,["onChange","label","indeterminate"])])]})),_:2},1032,["modelValue"]),(0,t.Wm)(h,{modelValue:p.checkedPermissionNames,"onUpdate:modelValue":n[1]||(n[1]=function(e){return p.checkedPermissionNames=e})},{default:(0,t.w5)((function(){return[(0,t._)("ul",l,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e,(function(n,u){return(0,t.wg)(),(0,t.iD)("li",{class:"permissions-li",key:u},[(0,t.Wm)(f,{label:n.name,value:p.permissionModuleIds.indexOf(n.id)>-1,onChange:function(t){return p.singleCheck(n.id,e,r)}},null,8,["label","value","onChange"])])})),128))])]})),_:2},1032,["modelValue"])])})),128))])])],512)),[[d,p.loading]])}var m=r(48534),v=(r(35666),r(41539),r(54747),r(91038),r(78783),r(70189),r(33948),r(47042),r(21249),r(92222),r(57327),r(40561),r(62931)),f=r(41301),h={props:["id","title"],setup:function(e,n){var r=(0,v.iH)(!1),u=(0,v.iH)({}),a=(0,v.iH)([]),i=(0,v.iH)([]),s=(0,v.iH)([]),o=(0,v.iH)([]),c=function(){var r=(0,m.Z)(regeneratorRuntime.mark((function r(){var t,c,l;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,f["default"].getAllPermissions();case 2:if(u.value=r.sent,!e.id){r.next=13;break}return r.next=6,f["default"].getOneGroup(e.id);case 6:t=r.sent,c=[],l={},t.permissions.forEach((function(e){i.value.push(e.id),o.value.push(e.name),c.push(e.module),l[e.module]?l[e.module]++:l[e.module]=1})),c=Array.from(new Set(c)),c.forEach((function(e){u.value[e].length!==l[e]&&a.value.push(e)})),s.value=Array.from(new Set(c));case 13:n.emit("getCacheAuthIds",i.value.slice()),n.emit("updatePermissions",i.value),n.emit("updateAllPermissions",u.value);case 16:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();(0,t.bv)((0,m.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,r.value=!0,e.next=4,c();case 4:r.value=!1,e.next=11;break;case 7:e.prev=7,e.t0=e["catch"](0),r.value=!1,console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])}))));var l=function(e,r,t){var u=r.map((function(e){return e.id})),c=r.map((function(e){return e.name}));e?(i.value=Array.from(new Set(i.value.concat(u))),o.value=Array.from(new Set(o.value.concat(c))),s.value.includes(t)||s.value.push(t)):(i.value=i.value.filter((function(e){return!u.includes(e)})),o.value=o.value.filter((function(e){return!c.includes(e)})),s.value=s.value.filter((function(e){return e!==t}))),a.value=a.value.filter((function(e){return e!==t})),n.emit("updatePermissions",i.value)},p=function(e,r,t){var u=r.map((function(e){return e.id})),o=0,c=i.value.indexOf(e);-1===c?i.value.push(e):i.value.splice(c,1),u.forEach((function(e){i.value.indexOf(e)>-1&&o++,u.length===o?(s.value.push(t),a.value=a.value.filter((function(e){return e!==t}))):0===o?(s.value=s.value.filter((function(e){return e!==t})),a.value=a.value.filter((function(e){return e!==t}))):(s.value=s.value.filter((function(e){return e!==t})),a.value.includes(t)||a.value.push(t))})),n.emit("updatePermissions",i.value)};return{loading:r,moduleCheck:l,singleCheck:p,allPermissions:u,halfPermissions:a,getGroupPermissions:c,permissionModuleIds:i,permissionModuleNames:s,checkedPermissionNames:o}}},d=r(83744);const g=(0,d.Z)(h,[["render",p],["__scopeId","data-v-0a2b5704"]]);var w=g}}]);
//# sourceMappingURL=7972.0bfb6a83.js.map