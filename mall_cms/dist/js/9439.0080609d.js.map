{"version":3,"file":"js/9439.0080609d.js","mappings":"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","sources":["webpack://lin-cms-vue/./src/view/coupon/coupon-list.vue","webpack://lin-cms-vue/./src/view/coupon/coupon-list.vue?5a2f"],"sourcesContent":["<template>\n  <div>\n    <div v-if=\"!showEdit\" class=\"container\">\n      <div class=\"header\">\n        <div class=\"title\">优惠卷列表</div>\n        <!-- <el-button @click.prevent=\"addCoupon\" type=\"primary\" plain size=\"medium\">添加优惠卷</el-button> -->\n      </div>\n\n      <el-table stripe v-loading=\"loading\" :data=\"tableData\">\n        <el-table-column prop=\"id\" label=\"id\" width=\"100\"></el-table-column>\n        <el-table-column :show-overflow-tooltip=\"true\" prop=\"title\" label=\"标题\" width=\"250\"></el-table-column>\n        <el-table-column prop=\"full_money\" label=\"满减额\" width=\"150\"></el-table-column>\n        <el-table-column :show-overflow-tooltip=\"true\" prop=\"minus\" label=\"优惠额\" width=\"150\"></el-table-column>\n        <el-table-column :show-overflow-tooltip=\"true\" prop=\"rate\" label=\"折扣\" width=\"150\"></el-table-column>\n        <el-table-column prop=\"type\" label=\"类型\" width=\"150\">\n          <template  #default=\"scope\">{{ scope.row.type | typeFormat }}</template>\n        </el-table-column>\n        <el-table-column prop=\"start_time\" label=\"开始时间\" width=\"200\">\n          <template  #default=\"scope\">{{ scope.row.start_time | dateFormat }}</template>\n        </el-table-column>\n        <el-table-column prop=\"end_time\" label=\"结束时间\" width=\"200\">\n          <template #default=\"scope\">{{ scope.row.end_time | dateFormat }}</template>\n        </el-table-column>\n        <el-table-column\n          :show-overflow-tooltip=\"true\"\n          prop=\"description\"\n          min-width=\"200\"\n          label=\"描述\"\n        ></el-table-column>\n        <el-table-column fixed=\"right\" width=\"150\" label=\"操作\">\n          <template #default=\"scope\">\n            <el-button @click.prevent=\"handleEdit(scope.row)\" type=\"primary\" plain size=\"mini\">编辑</el-button>\n            <el-button\n              v-permission=\"{ auth: ['删除优惠卷'], type: 'disabled' }\"\n              @click.prevent=\"handleDelete(scope.row)\"\n              type=\"danger\"\n              size=\"mini\"\n              plain\n              >删除</el-button\n            >\n          </template>\n        </el-table-column>\n      </el-table>\n\n      <el-table stripe v-loading=\"loading\" :data=\"templates\">\n        <el-table-column prop=\"id\" label=\"id\" width=\"100\"></el-table-column>\n        <el-table-column prop=\"title\" label=\"名称\" width=\"250\"></el-table-column>\n        <el-table-column prop=\"full_money\" label=\"满减额\" width=\"150\"></el-table-column>\n        <el-table-column prop=\"minus\" label=\"优惠额\" width=\"150\"></el-table-column>\n        <el-table-column prop=\"rate\" label=\"折扣\" width=\"150\"></el-table-column>\n        <el-table-column prop=\"type\" label=\"类型\" width=\"150\">\n          <template #default=\"scope\">{{ scope.row.type | typeFormat }}</template>\n        </el-table-column>\n        <el-table-column prop=\"description\" label=\"描述\" min-width=\"300\"></el-table-column>\n        <el-table-column fixed=\"right\" width=\"300\" label=\"操作\">\n          <template #default=\"scope\">\n            <el-button\n              v-permission=\"{ permission: ['创建优惠卷'], type: 'disabled' }\"\n              @click.prevent=\"addCoupon(scope.row)\"\n              type=\"primary\"\n              plain\n              size=\"mini\"\n              >从当前模板创建</el-button\n            >\n          </template>\n        </el-table-column>\n      </el-table>\n    </div>\n    <coupon-edit\n      v-else\n      @editClose=\"editClose\"\n      :templateData=\"templateData\"\n      :couponId=\"couponId\"\n      :isCreate=\"isCreate\"\n      :activityId=\"activityId\"\n    ></coupon-edit>\n  </div>\n</template>\n\n<script>\nimport dayjs from 'dayjs'\nimport Coupon from '@/model/coupon'\nimport CouponEdit from './CouponEdit'\n\nexport default {\n  components: { CouponEdit },\n  props: {\n    activityId: {\n      type: String,\n      default: null,\n    },\n  },\n  data() {\n    return {\n      couponId: null,\n      isCreate: false,\n      tableData: [],\n      templates: [],\n      showEdit: false,\n      totalNums: 0,\n      currentPage: 1,\n      pageCount: 10,\n      refreshPagination: true,\n      templateData: null,\n      loading: false,\n    }\n  },\n  async created() {\n    this.$nextTick(() => {\n      this.loading = true\n      this.getCoupons()\n      this.getTemplates()\n      this.loading = false\n    })\n  },\n  methods: {\n    async getCoupons() {\n      const coupons = await Coupon.getListByActivityId(this.activityId)\n      this.tableData = coupons\n    },\n    async getTemplates() {\n      const templates = await Coupon.getCouponTemplates()\n      this.templates = templates\n    },\n    async handleCurrentChange(val) {\n      this.currentPage = val\n      this.loading = true\n      this.getCoupons()\n      this.loading = false\n    },\n    handleEdit(val) {\n      this.isCreate = false\n      this.couponId = `${val.id}`\n      this.showEdit = true\n    },\n    handleDelete(val) {\n      this.$confirm('此操作将永久删除该项, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning',\n      }).then(async () => {\n        const res = await Coupon.deleteCoupon(val.id)\n        if (res.code < window.MAX_SUCCESS_CODE) {\n          this.getCoupons()\n          this.$message({\n            type: 'success',\n            message: `${res.message}`,\n          })\n        }\n      })\n    },\n    addCoupon(templateData) {\n      this.templateData = templateData\n      this.isCreate = true\n      this.couponId = null\n      this.showEdit = true\n      this.getTemplates()\n    },\n    editClose() {\n      this.showEdit = false\n      this.getCoupons()\n    },\n  },\n  filters: {\n    dateFormat(val) {\n      return dayjs(val).format('YYYY-MM-DD HH:mm:ss')\n    },\n    typeFormat(val) {\n      switch (val) {\n        case 1:\n          return '满减券'\n        case 2:\n          return '折扣券'\n        case 3:\n          return '无门槛券'\n        case 4:\n          return '满金额折扣券'\n        default:\n          return val\n      }\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.container {\n  padding: 0 30px;\n\n  .header {\n    display: flex;\n    align-items: center;\n\n    .title {\n      height: 59px;\n      line-height: 59px;\n      color: $parent-title-color;\n      font-size: 16px;\n      font-weight: 500;\n    }\n  }\n\n  .pagination {\n    display: flex;\n    justify-content: flex-end;\n    margin: 20px;\n  }\n}\n</style>\n","import { render } from \"./coupon-list.vue?vue&type=template&id=093feb16&scoped=true\"\nimport script from \"./coupon-list.vue?vue&type=script&lang=js\"\nexport * from \"./coupon-list.vue?vue&type=script&lang=js\"\n\nimport \"./coupon-list.vue?vue&type=style&index=0&id=093feb16&lang=scss&scoped=true\"\n\nimport exportComponent from \"/Users/zhahn/Documents/Hahn/自考/mall/mall_cms/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-093feb16\"]])\n\nexport default __exports__"],"names":["class","showEdit","editClose","templateData","couponId","isCreate","activityId","stripe","data","tableData","prop","label","width","default","scope","row","type","typeFormat","start_time","dateFormat","end_time","fixed","handleEdit","plain","size","handleDelete","loading","templates","addCoupon","components","CouponEdit","props","String","totalNums","currentPage","pageCount","refreshPagination","created","$nextTick","getCoupons","getTemplates","methods","coupons","handleCurrentChange","val","this","id","$confirm","confirmButtonText","cancelButtonText","then","res","code","window","MAX_SUCCESS_CODE","$message","message","filters","format","__exports__","render"],"sourceRoot":""}