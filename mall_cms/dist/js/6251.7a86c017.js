"use strict";(self["webpackChunklin_cms_vue"]=self["webpackChunklin_cms_vue"]||[]).push([[6251,8836],{78836:function(e,n,t){t.r(n);var r=t(48534),a=t(13087),i=t(62833),u=(t(35666),t(12109)),o=function(){function e(){(0,a.Z)(this,e)}return(0,i.Z)(e,null,[{key:"addBanner",value:function(){var e=(0,r.Z)(regeneratorRuntime.mark((function e(n){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,u.post)("v1/banner",n);case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));function n(n){return e.apply(this,arguments)}return n}()},{key:"getBanner",value:function(){var e=(0,r.Z)(regeneratorRuntime.mark((function e(n){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,u.get)("v1/banner/".concat(n));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));function n(n){return e.apply(this,arguments)}return n}()},{key:"editBanner",value:function(){var e=(0,r.Z)(regeneratorRuntime.mark((function e(n,t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,u.put)("v1/banner/".concat(n),t);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));function n(n,t){return e.apply(this,arguments)}return n}()},{key:"deleteBanner",value:function(){var e=(0,r.Z)(regeneratorRuntime.mark((function e(n){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,u._delete)("v1/banner/".concat(n));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));function n(n){return e.apply(this,arguments)}return n}()},{key:"getBanners",value:function(){var e=(0,r.Z)(regeneratorRuntime.mark((function e(){var n,t,r,a=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=a.length>0&&void 0!==a[0]?a[0]:0,t=a.length>1&&void 0!==a[1]?a[1]:10,e.next=4,(0,u.get)("v1/banner/page",{page:n,count:t});case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));function n(){return e.apply(this,arguments)}return n}()}]),e}();n["default"]=o},26251:function(e,n,t){t.r(n),t.d(n,{default:function(){return S}});t(68309),t(82526),t(41817);var r=t(66252),a=t(58061),i=function(e){return(0,r.dD)("data-v-66c3cc55"),e=e(),(0,r.Cn)(),e},u={key:0,class:"container"},o={class:"title"},s=i((function(){return(0,r._)("span",null,"修改Banner",-1)})),l=(0,r.Uk)(),c=i((function(){return(0,r._)("i",{class:"iconfont icon-fanhui"},null,-1)})),m=(0,r.Uk)(" 返回 "),d=[c,m],p={class:"wrap"},f=(0,r.Uk)("保 存"),h={class:"header"},w={class:"title"},g=i((function(){return(0,r._)("span",null,"Banner-Item列表",-1)})),v=(0,r.Uk)("新增Banner-Item"),b=(0,r.Uk)("编辑"),_=(0,r.Uk)("删除");function y(e,n,t,i,c,m){var y=(0,r.up)("el-divider"),k=(0,r.up)("el-input"),x=(0,r.up)("el-form-item"),C=(0,r.up)("upload-imgs"),W=(0,r.up)("el-button"),I=(0,r.up)("el-form"),R=(0,r.up)("el-col"),D=(0,r.up)("el-row"),B=(0,r.up)("el-table-column"),E=(0,r.up)("el-image"),S=(0,r.up)("el-table"),Z=(0,r.up)("banner-item-edit"),U=(0,r.Q2)("permission"),V=(0,r.Q2)("loading");return c.showEdit?((0,r.wg)(),(0,r.j4)(Z,{key:1,onEditClose:m.editClose,bannerId:t.bannerId,isCreate:c.isCreate,editID:c.editID},null,8,["onEditClose","bannerId","isCreate","editID"])):((0,r.wg)(),(0,r.iD)("div",u,[(0,r._)("div",o,[s,l,(0,r._)("span",{class:"back",onClick:n[0]||(n[0]=function(){return m.back&&m.back.apply(m,arguments)})},d)]),(0,r.Wm)(y),(0,r._)("div",p,[(0,r.Wm)(D,null,{default:(0,r.w5)((function(){return[(0,r.Wm)(R,{lg:16,md:20,sm:24,xs:24},{default:(0,r.w5)((function(){return[(0,r.wy)((0,r.Wm)(I,{model:c.form,"status-icon":"",ref:"form","label-width":"100px",onSubmit:n[5]||(n[5]=(0,a.iM)((function(){}),["prevent"]))},{default:(0,r.w5)((function(){return[(0,r.Wm)(x,{label:"名称",prop:"name"},{default:(0,r.w5)((function(){return[(0,r.Wm)(k,{size:"medium",modelValue:c.form.name,"onUpdate:modelValue":n[1]||(n[1]=function(e){return c.form.name=e}),placeholder:"请填写名称"},null,8,["modelValue"])]})),_:1}),(0,r.Wm)(x,{label:"标题",prop:"title"},{default:(0,r.w5)((function(){return[(0,r.Wm)(k,{size:"medium",modelValue:c.form.title,"onUpdate:modelValue":n[2]||(n[2]=function(e){return c.form.title=e}),placeholder:"请填写标题"},null,8,["modelValue"])]})),_:1}),(0,r.Wm)(x,{label:"主图",prop:"img"},{default:(0,r.w5)((function(){return[(0,r.Wm)(C,{ref:"uploadEle",value:c.initData,"max-num":c.mainMaxNum},null,8,["value","max-num"])]})),_:1}),(0,r.Wm)(x,{label:"描述",prop:"description"},{default:(0,r.w5)((function(){return[(0,r.Wm)(k,{size:"medium",modelValue:c.form.description,"onUpdate:modelValue":n[3]||(n[3]=function(e){return c.form.description=e}),type:"textarea",rows:4,placeholder:"请填写描述"},null,8,["modelValue"])]})),_:1}),(0,r.Wm)(x,{class:"submit"},{default:(0,r.w5)((function(){return[(0,r.wy)((0,r.Wm)(W,{type:"primary",onClick:n[4]||(n[4]=function(e){return m.submitForm("form")})},{default:(0,r.w5)((function(){return[f]})),_:1},512),[[U,{permission:"更新Banner",type:"disabled"}]])]})),_:1})]})),_:1},8,["model"]),[[V,c.loading]])]})),_:1})]})),_:1})]),(0,r._)("div",null,[(0,r.Wm)(y),(0,r._)("div",h,[(0,r._)("div",w,[g,(0,r.Wm)(W,{onClick:(0,a.iM)(m.addBannerItem,["prevent"]),class:"add-btn",type:"primary",plain:""},{default:(0,r.w5)((function(){return[v]})),_:1},8,["onClick"])])]),(0,r.Wm)(D,{class:"inner-container"},{default:(0,r.w5)((function(){return[(0,r.wy)((0,r.Wm)(S,{stripe:"",data:c.bannerItems},{default:(0,r.w5)((function(){return[(0,r.Wm)(B,{prop:"id",label:"id",width:"100"}),(0,r.Wm)(B,{prop:"img",label:"图片",width:"200"},{default:(0,r.w5)((function(e){return[(0,r.Wm)(E,{src:e.row.img,"preview-src-list":c.imgSrcList,style:{"max-height":"50px","max-width":"100px"}},null,8,["src","preview-src-list"])]})),_:1}),(0,r.Wm)(B,{prop:"name",label:"名称",width:"150"}),(0,r.Wm)(B,{prop:"type_name",label:"类型",width:"150"}),(0,r.Wm)(B,{prop:"spu_name",label:"SPU名称",width:"150"}),(0,r.Wm)(B,{prop:"theme_name",label:"主题名称",width:"150"}),(0,r.Wm)(B,{fixed:"right",width:"150",label:"操作"},{default:(0,r.w5)((function(e){return[(0,r.Wm)(W,{onClick:(0,a.iM)((function(n){return m.handleEdit(e.row)}),["prevent"]),type:"primary",plain:"",size:"mini"},{default:(0,r.w5)((function(){return[b]})),_:2},1032,["onClick"]),(0,r.wy)((0,r.Wm)(W,{onClick:(0,a.iM)((function(n){return m.handleDelete(e.row)}),["prevent"]),type:"danger",plain:"",size:"mini"},{default:(0,r.w5)((function(){return[_]})),_:2},1032,["onClick"]),[[U,{permission:"删除Banner item",type:"disabled"}]])]})),_:1})]})),_:1},8,["data"]),[[V,c.loading]])]})),_:1})])]))}var k=t(95082),x=t(48534),C=(t(35666),t(9653),t(41539),t(54747),t(78836)),W=t(646),I=t(5892),R=t(93395),D={components:{UploadImgs:I["default"],BannerItemEdit:R["default"]},props:{bannerId:{type:Number}},data:function(){return{loading:!1,form:{name:"",title:"",description:"",keyword:null},bannerItems:[],imgSrcList:[],mainMaxNum:1,initData:[],isCreate:!1,showEdit:!1,editID:0,suggestions:[]}},mounted:function(){var e=this;return(0,x.Z)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.loading=!0,e.getDetail(),e.loading=!1;case 3:case"end":return n.stop()}}),n)})))()},methods:{getValue:function(){var e=this;return(0,x.Z)(regeneratorRuntime.mark((function n(){var t;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$refs.uploadEle.getValue();case 2:t=n.sent,t&&t.length>0&&(e.form.img=t[0].display);case 4:case"end":return n.stop()}}),n)})))()},getDetail:function(){var e=this;return(0,x.Z)(regeneratorRuntime.mark((function n(){var t;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,C["default"].getBanner(e.bannerId);case 2:t=n.sent,e.form=t,e.initData=[{id:t.id,display:t.img}],e.bannerItems=t.items,e.bannerItems.forEach((function(e){1==e.type?e.type_name="无类型":2==e.type?e.type_name="Spu":3==e.type&&(e.type_name="主题")})),e.initImgSrcList();case 8:case"end":return n.stop()}}),n)})))()},initImgSrcList:function(){var e=this;this.bannerItems.forEach((function(n){n.img&&e.imgSrcList.push(n.img)}))},submitForm:function(){var e=this;return(0,x.Z)(regeneratorRuntime.mark((function n(){var t,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.getValue();case 2:return t=(0,k.Z)({},e.form),n.next=5,C["default"].editBanner(e.bannerId,t);case 5:r=n.sent,r.code<window.MAX_SUCCESS_CODE&&(e.$message.success("".concat(r.message)),e.$emit("detailClose"));case 7:case"end":return n.stop()}}),n)})))()},resetForm:function(e){this.$refs[e].resetFields()},back:function(){this.$emit("detailClose")},addBannerItem:function(){this.isCreate=!0,this.editID=0,this.showEdit=!0},editClose:function(){this.showEdit=!1,this.getDetail()},handleEdit:function(e){this.isCreate=!1,this.editID=e.id,this.showEdit=!0},handleDelete:function(e){var n=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((0,x.Z)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,W["default"].deleteBannerItem(e.id);case 2:r=t.sent,r.code<window.MAX_SUCCESS_CODE&&(n.getDetail(),n.$message({type:"success",message:"".concat(r.message)}));case 4:case"end":return t.stop()}}),t)}))))}}},B=t(83744);const E=(0,B.Z)(D,[["render",y],["__scopeId","data-v-66c3cc55"]]);var S=E}}]);
//# sourceMappingURL=6251.7a86c017.js.map