"use strict";(self["webpackChunklin_cms_vue"]=self["webpackChunklin_cms_vue"]||[]).push([[7278,4154],{44154:function(e,t,n){n.r(t);var r=n(48534),u=n(13087),a=n(62833),o=n(82482),i=(n(35666),n(12109)),l=function(){function e(){(0,u.Z)(this,e)}return(0,a.Z)(e,null,[{key:"addCoupon",value:function(){var e=(0,r.Z)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.post)("v1/coupon",t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getCoupon",value:function(){var e=(0,r.Z)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.get)("v1/coupon/".concat(t));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"editCoupon",value:function(){var e=(0,r.Z)(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.put)("v1/coupon/".concat(t),n);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"deleteCoupon",value:function(){var e=(0,r.Z)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i._delete)("v1/coupon/".concat(t));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"addCouponTemplate",value:function(){var e=(0,r.Z)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.post)("v1/coupon/template",t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"editCouponTemplate",value:function(){var e=(0,r.Z)(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.put)("v1/coupon/template/".concat(t),n);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"getCouponTemplate",value:function(){var e=(0,r.Z)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.get)("v1/coupon/template/".concat(t));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"deleteCouponTemplate",value:function(){var e=(0,r.Z)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i._delete)("v1/coupon/template/".concat(t));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getCouponTemplates",value:function(){var e=(0,r.Z)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.get)("v1/coupon/templates");case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getListByActivityId",value:function(){var e=(0,r.Z)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.get)("v1/coupon/list?id=".concat(t));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}();(0,o.Z)(l,"types",["满减券","折扣券","无门槛券","满金额折扣券"]),t["default"]=l},77278:function(e,t,n){n.r(t),n.d(t,{default:function(){return x}});n(82526),n(41817);var r=n(66252),u=n(56612),a=n(58061),o=function(e){return(0,r.dD)("data-v-77974340"),e=e(),(0,r.Cn)(),e},i={class:"container"},l={class:"title"},c=o((function(){return(0,r._)("i",{class:"iconfont icon-fanhui"},null,-1)})),s=(0,r.Uk)(" 返回 "),p=[c,s],m={class:"wrap"},f=(0,r.Uk)("保 存");function d(e,t,n,o,c,s){var d=(0,r.up)("el-input"),v=(0,r.up)("el-form-item"),w=(0,r.up)("el-input-number"),h=(0,r.up)("el-option"),g=(0,r.up)("el-select"),k=(0,r.up)("el-date-picker"),y=(0,r.up)("el-button"),_=(0,r.up)("el-form"),b=(0,r.up)("el-col"),x=(0,r.up)("el-row"),C=(0,r.Q2)("permission");return(0,r.wg)(),(0,r.iD)("div",i,[(0,r._)("div",l,[(0,r._)("span",null,(0,u.zw)(n.isCreate?"创建优惠卷":"更新优惠卷"),1),(0,r._)("span",{class:"back",onClick:t[0]||(t[0]=function(){return s.back&&s.back.apply(s,arguments)})},p)]),(0,r._)("div",m,[(0,r.Wm)(x,null,{default:(0,r.w5)((function(){return[(0,r.Wm)(b,{lg:16,md:20,sm:24,xs:24},{default:(0,r.w5)((function(){return[(0,r.Wm)(_,{model:c.form,"status-icon":"",ref:"form","label-width":"100px",onSubmit:t[9]||(t[9]=(0,a.iM)((function(){}),["prevent"]))},{default:(0,r.w5)((function(){return[(0,r.Wm)(v,{label:"标题",prop:"title"},{default:(0,r.w5)((function(){return[(0,r.Wm)(d,{size:"medium",modelValue:c.form.title,"onUpdate:modelValue":t[1]||(t[1]=function(e){return c.form.title=e}),placeholder:"请填写优惠卷标题"},null,8,["modelValue"])]})),_:1}),(0,r.Wm)(v,{label:"满减额",prop:"full_money"},{default:(0,r.w5)((function(){return[(0,r.Wm)(w,{modelValue:c.form.full_money,"onUpdate:modelValue":t[2]||(t[2]=function(e){return c.form.full_money=e}),precision:2,step:1},null,8,["modelValue"])]})),_:1}),(0,r.Wm)(v,{label:"优惠额",prop:"minus"},{default:(0,r.w5)((function(){return[(0,r.Wm)(w,{modelValue:c.form.minus,"onUpdate:modelValue":t[3]||(t[3]=function(e){return c.form.minus=e}),precision:2,step:1},null,8,["modelValue"])]})),_:1}),(0,r.Wm)(v,{label:"折扣",prop:"rate"},{default:(0,r.w5)((function(){return[(0,r.Wm)(w,{modelValue:c.form.rate,"onUpdate:modelValue":t[4]||(t[4]=function(e){return c.form.rate=e}),precision:2,step:.1,max:1},null,8,["modelValue","step"])]})),_:1}),(0,r.Wm)(v,{label:"类型",prop:"type"},{default:(0,r.w5)((function(){return[(0,r.Wm)(g,{modelValue:c.form.type,"onUpdate:modelValue":t[5]||(t[5]=function(e){return c.form.type=e}),placeholder:"请填写类型"},{default:(0,r.w5)((function(){return[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(c.types,(function(e,t){return(0,r.wg)(),(0,r.j4)(h,{key:e,label:e,value:t+1},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),(0,r.Wm)(v,{label:"时间"},{default:(0,r.w5)((function(){return[(0,r.Wm)(k,{modelValue:c.range,"onUpdate:modelValue":t[6]||(t[6]=function(e){return c.range=e}),type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":c.pickerOptions},null,8,["modelValue","picker-options"])]})),_:1}),(0,r.Wm)(v,{label:"描述",prop:"description"},{default:(0,r.w5)((function(){return[(0,r.Wm)(d,{size:"medium",modelValue:c.form.description,"onUpdate:modelValue":t[7]||(t[7]=function(e){return c.form.description=e}),placeholder:"请填写优惠卷描述"},null,8,["modelValue"])]})),_:1}),(0,r.Wm)(v,{class:"submit"},{default:(0,r.w5)((function(){return[(0,r.wy)((0,r.Wm)(y,{type:"primary",onClick:t[8]||(t[8]=function(e){return s.submitForm("form")})},{default:(0,r.w5)((function(){return[f]})),_:1},512),[[C,{permission:["创建优惠卷","更新优惠卷"],type:"disabled"}]])]})),_:1})]})),_:1},8,["model"])]})),_:1})]})),_:1})])])}var v=n(95082),w=n(48534),h=(n(35666),n(27484)),g=n.n(h),k=n(44154),y={props:{isCreate:{type:Boolean,default:!1},couponId:{type:String,default:null},activityId:{type:String,default:null},templateData:{type:Object,default:null}},data:function(){return{form:{name:"",title:"",full_money:null,minus:null,rate:null,type:null,activity_id:null},types:[],range:"",pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,n=new Date;n.setTime(n.getTime()-6048e5),e.$emit("pick",[n,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,n=new Date;n.setTime(n.getTime()-2592e6),e.$emit("pick",[n,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,n=new Date;n.setTime(n.getTime()-7776e6),e.$emit("pick",[n,t])}}]}}},mounted:function(){var e=this;return(0,w.Z)(regeneratorRuntime.mark((function t(){var n,r,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.types=k["default"].types,e.isCreate){t.next=11;break}return t.next=4,k["default"].getCoupon(e.couponId);case 4:n=t.sent,e.form=n,r=new Date(n.end_time),u=new Date(n.start_time),e.range=[u,r],t.next=12;break;case 11:e.form=e.templateData;case 12:case"end":return t.stop()}}),t)})))()},methods:{submitForm:function(e){var t=this;return(0,w.Z)(regeneratorRuntime.mark((function n(){var r,u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.form.remark="全场无门槛立减",t.form.whole_store=1,t.form.activity_id=t.activityId,n.prev=3,r=(0,v.Z)({},t.form),0===r.rate&&(r.rate=null),0===r.minus&&(r.minus=null),0===r.full_money&&(r.full_money=null),r.start_time=t.dateFormat(t.range[0]),r.end_time=t.dateFormat(t.range[1]),!t.isCreate){n.next=16;break}return n.next=13,k["default"].addCoupon(r);case 13:u=n.sent,n.next=19;break;case 16:return n.next=18,k["default"].editCoupon(t.couponId,r);case 18:u=n.sent;case 19:u.code<window.MAX_SUCCESS_CODE&&(t.$message.success("".concat(u.message)),t.resetForm(e),t.$confirm("是否返回上一页?","提示",{confirmButtonText:"是",cancelButtonText:"否",type:"info"}).then((0,w.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$emit("editClose");case 1:case"end":return e.stop()}}),e)}))))),n.next=25;break;case 22:n.prev=22,n.t0=n["catch"](3),console.error(n.t0);case 25:case"end":return n.stop()}}),n,null,[[3,22]])})))()},resetForm:function(e){this.$refs[e].resetFields()},back:function(){this.$emit("editClose")},dateFormat:function(e){return g()(e).format("YYYY-MM-DD HH:mm:ss")}}},_=n(83744);const b=(0,_.Z)(y,[["render",d],["__scopeId","data-v-77974340"]]);var x=b}}]);
//# sourceMappingURL=7278.5108c18b.js.map