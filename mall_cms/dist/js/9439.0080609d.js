"use strict";(self["webpackChunklin_cms_vue"]=self["webpackChunklin_cms_vue"]||[]).push([[9439,9311],{95387:function(t,e,n){n.r(e),n.d(e,{default:function(){return b}});var r=n(66252),i=n(56612),a=n(58061),o=function(t){return(0,r.dD)("data-v-093feb16"),t=t(),(0,r.Cn)(),t},u={key:0,class:"container"},l=o((function(){return(0,r._)("div",{class:"header"},[(0,r._)("div",{class:"title"},"优惠卷列表")],-1)})),s=(0,r.Uk)("编辑"),d=(0,r.Uk)("删除"),p=(0,r.Uk)("从当前模板创建");function c(t,e,n,o,c,m){var w=(0,r.up)("el-table-column"),f=(0,r.up)("el-button"),h=(0,r.up)("el-table"),g=(0,r.up)("coupon-edit"),v=(0,r.Q2)("permission"),C=(0,r.Q2)("loading");return(0,r.wg)(),(0,r.iD)("div",null,[c.showEdit?((0,r.wg)(),(0,r.j4)(g,{key:1,onEditClose:m.editClose,templateData:c.templateData,couponId:c.couponId,isCreate:c.isCreate,activityId:n.activityId},null,8,["onEditClose","templateData","couponId","isCreate","activityId"])):((0,r.wg)(),(0,r.iD)("div",u,[l,(0,r.wy)((0,r.Wm)(h,{stripe:"",data:c.tableData},{default:(0,r.w5)((function(){return[(0,r.Wm)(w,{prop:"id",label:"id",width:"100"}),(0,r.Wm)(w,{"show-overflow-tooltip":!0,prop:"title",label:"标题",width:"250"}),(0,r.Wm)(w,{prop:"full_money",label:"满减额",width:"150"}),(0,r.Wm)(w,{"show-overflow-tooltip":!0,prop:"minus",label:"优惠额",width:"150"}),(0,r.Wm)(w,{"show-overflow-tooltip":!0,prop:"rate",label:"折扣",width:"150"}),(0,r.Wm)(w,{prop:"type",label:"类型",width:"150"},{default:(0,r.w5)((function(e){return[(0,r.Uk)((0,i.zw)(e.row.type|t.typeFormat),1)]})),_:1}),(0,r.Wm)(w,{prop:"start_time",label:"开始时间",width:"200"},{default:(0,r.w5)((function(e){return[(0,r.Uk)((0,i.zw)(e.row.start_time|t.dateFormat),1)]})),_:1}),(0,r.Wm)(w,{prop:"end_time",label:"结束时间",width:"200"},{default:(0,r.w5)((function(e){return[(0,r.Uk)((0,i.zw)(e.row.end_time|t.dateFormat),1)]})),_:1}),(0,r.Wm)(w,{"show-overflow-tooltip":!0,prop:"description","min-width":"200",label:"描述"}),(0,r.Wm)(w,{fixed:"right",width:"150",label:"操作"},{default:(0,r.w5)((function(t){return[(0,r.Wm)(f,{onClick:(0,a.iM)((function(e){return m.handleEdit(t.row)}),["prevent"]),type:"primary",plain:"",size:"mini"},{default:(0,r.w5)((function(){return[s]})),_:2},1032,["onClick"]),(0,r.wy)((0,r.Wm)(f,{onClick:(0,a.iM)((function(e){return m.handleDelete(t.row)}),["prevent"]),type:"danger",size:"mini",plain:""},{default:(0,r.w5)((function(){return[d]})),_:2},1032,["onClick"]),[[v,{auth:["删除优惠卷"],type:"disabled"}]])]})),_:1})]})),_:1},8,["data"]),[[C,c.loading]]),(0,r.wy)((0,r.Wm)(h,{stripe:"",data:c.templates},{default:(0,r.w5)((function(){return[(0,r.Wm)(w,{prop:"id",label:"id",width:"100"}),(0,r.Wm)(w,{prop:"title",label:"名称",width:"250"}),(0,r.Wm)(w,{prop:"full_money",label:"满减额",width:"150"}),(0,r.Wm)(w,{prop:"minus",label:"优惠额",width:"150"}),(0,r.Wm)(w,{prop:"rate",label:"折扣",width:"150"}),(0,r.Wm)(w,{prop:"type",label:"类型",width:"150"},{default:(0,r.w5)((function(e){return[(0,r.Uk)((0,i.zw)(e.row.type|t.typeFormat),1)]})),_:1}),(0,r.Wm)(w,{prop:"description",label:"描述","min-width":"300"}),(0,r.Wm)(w,{fixed:"right",width:"300",label:"操作"},{default:(0,r.w5)((function(t){return[(0,r.wy)((0,r.Wm)(f,{onClick:(0,a.iM)((function(e){return m.addCoupon(t.row)}),["prevent"]),type:"primary",plain:"",size:"mini"},{default:(0,r.w5)((function(){return[p]})),_:2},1032,["onClick"]),[[v,{permission:["创建优惠卷"],type:"disabled"}]])]})),_:1})]})),_:1},8,["data"]),[[C,c.loading]])]))])}var m=n(48534),w=(n(35666),n(27484)),f=n.n(w),h=n(44154),g=n(77278),v={components:{CouponEdit:g["default"]},props:{activityId:{type:String,default:null}},data:function(){return{couponId:null,isCreate:!1,tableData:[],templates:[],showEdit:!1,totalNums:0,currentPage:1,pageCount:10,refreshPagination:!0,templateData:null,loading:!1}},created:function(){var t=this;return(0,m.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$nextTick((function(){t.loading=!0,t.getCoupons(),t.getTemplates(),t.loading=!1}));case 1:case"end":return e.stop()}}),e)})))()},methods:{getCoupons:function(){var t=this;return(0,m.Z)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,h["default"].getListByActivityId(t.activityId);case 2:n=e.sent,t.tableData=n;case 4:case"end":return e.stop()}}),e)})))()},getTemplates:function(){var t=this;return(0,m.Z)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,h["default"].getCouponTemplates();case 2:n=e.sent,t.templates=n;case 4:case"end":return e.stop()}}),e)})))()},handleCurrentChange:function(t){var e=this;return(0,m.Z)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.currentPage=t,e.loading=!0,e.getCoupons(),e.loading=!1;case 4:case"end":return n.stop()}}),n)})))()},handleEdit:function(t){this.isCreate=!1,this.couponId="".concat(t.id),this.showEdit=!0},handleDelete:function(t){var e=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((0,m.Z)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,h["default"].deleteCoupon(t.id);case 2:r=n.sent,r.code<window.MAX_SUCCESS_CODE&&(e.getCoupons(),e.$message({type:"success",message:"".concat(r.message)}));case 4:case"end":return n.stop()}}),n)}))))},addCoupon:function(t){this.templateData=t,this.isCreate=!0,this.couponId=null,this.showEdit=!0,this.getTemplates()},editClose:function(){this.showEdit=!1,this.getCoupons()}},filters:{dateFormat:function(t){return f()(t).format("YYYY-MM-DD HH:mm:ss")},typeFormat:function(t){switch(t){case 1:return"满减券";case 2:return"折扣券";case 3:return"无门槛券";case 4:return"满金额折扣券";default:return t}}}},C=n(83744);const y=(0,C.Z)(v,[["render",c],["__scopeId","data-v-093feb16"]]);var b=y}}]);
//# sourceMappingURL=9439.0080609d.js.map