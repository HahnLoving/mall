{"version":3,"file":"js/7584.faf8fcc3.js","mappings":"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","sources":["webpack://lin-cms-vue/./src/model/category.js","webpack://lin-cms-vue/./src/view/category/category-edit.vue","webpack://lin-cms-vue/./src/view/category/category-edit.vue?ca8b","webpack://lin-cms-vue/./src/view/category/category-list.vue","webpack://lin-cms-vue/./src/view/category/category-list.vue?a313"],"sourcesContent":["import { post, get, put, _delete } from '@/lin/plugin/axios'\n\nclass Category {\n  static async addCategory(data) {\n    const res = await post('v1/category', data)\n    return res\n  }\n\n  static async getCategory(id) {\n    const res = await get(`v1/category/${id}`)\n    return res\n  }\n\n  static async editCategory(id, data) {\n    const res = await put(`v1/category/${id}`, data)\n    return res\n  }\n\n  static async deleteCategory(id) {\n    const res = await _delete(`v1/category/${id}`)\n    return res\n  }\n\n  /**\n   * 分页获取分类数据\n   * @param page\n   * @param count\n   * @param root 1: 父类\n   * @returns {Promise<*>}\n   */\n  static async getCategories(page = 0, count = 10, root = 1) {\n    const res = await get('v1/category/page', {\n      page,\n      count,\n      root,\n    })\n    return res\n  }\n\n  /**\n   * 分页获取子分类数据\n   * @param page\n   * @param count\n   * @param id 父分类id\n   * @returns {Promise<*>}\n   */\n  static async getSubCategories(page = 0, count = 10, id = 1) {\n    const res = await get('v1/category/sub-page', {\n      page,\n      count,\n      id,\n    })\n    return res\n  }\n\n  static async getList() {\n    const res = await get('v1/category/list')\n    return res\n  }\n}\n\nexport default Category\n","<template>\n  <!-- <el-dialog :append-to-body=\"true\" :before-close=\"handleClose\" :visible.sync=\"visible\"> -->\n    <div style=\"margin-top:-25px;\">\n      <div class=\"dialog-title\">\n        <span>{{ isCreate ? '创建分类' : '更新分类' }}</span>\n      </div>\n      <el-form :model=\"form\" status-icon ref=\"form\" label-width=\"100px\" @submit.native.prevent>\n        <el-form-item label=\"名称\" prop=\"name\">\n          <el-input size=\"medium\" v-model=\"form.name\" placeholder=\"请填写分类名\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"排序\" prop=\"index\">\n          <el-input size=\"medium\" v-model=\"form.index\" placeholder=\"请填写分类排序\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"显示上线\" prop=\"online\">\n          <el-switch\n            v-model=\"display\"\n            active-color=\"#13ce66\"\n            inactive-color=\"#ff4949\"\n            active-text=\"上线\"\n            inactive-text=\"下线\"\n          ></el-switch>\n        </el-form-item>\n        <el-form-item label=\"图片\" prop=\"img\">\n          <upload-imgs ref=\"uploadEle\" :max-num=\"maxNum\" :value=\"initData\" />\n        </el-form-item>\n        <el-form-item label=\"描述\" prop=\"description\">\n          <el-input size=\"medium\" v-model=\"form.description\" type=\"textarea\" :rows=\"1\" placeholder=\"请填写描述\">\n          </el-input>\n        </el-form-item>\n      </el-form>\n    </div>\n    <div slot=\"footer\" class=\"dialog-footer\" style=\"padding-left:5px;\">\n      <el-button type=\"primary\" @click=\"submitForm\" v-permission=\"{ permission: '更新分类', type: 'disabled' }\"\n        >确 定</el-button\n      >\n      <!-- <el-button @click=\"resetForm('form')\">重 置</el-button> -->\n    </div>\n  <!-- </el-dialog> -->\n</template>\n<script>\nimport Category from '@/model/category'\nimport UploadImgs from '@/component/base/upload-image'\n\nexport default {\n  components: {\n    UploadImgs,\n  },\n  props: {\n    dialogFormVisible: {\n      type: Boolean,\n      default: false,\n    },\n    isCreate: {\n      type: Boolean,\n      default: false,\n    },\n    categoryId: {\n      type: Number,\n      default: 0,\n    },\n    isSub: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  computed: {\n    visible: {\n      get() {\n        return this.dialogFormVisible\n      },\n      set() {},\n    },\n  },\n  data() {\n    return {\n      display: true,\n      initData: [],\n      maxNum: 1,\n      form: {\n        name: '',\n        is_root: 0,\n        parent_id: null,\n        description: '',\n        online: 1,\n        index: null,\n      },\n    }\n  },\n  watch: {\n    display(val) {\n      this.form.online = val ? 1 : 0\n    },\n  },\n  async mounted() {\n    if (!this.isCreate) {\n      const res = await Category.getCategory(this.categoryId)\n      this.form = res\n      this.display = res.online === 1\n      this.initData = [{ display: res.img }]\n    }\n    if (this.isSub) {\n      this.form.parent_id = this.$route.params.id\n      this.form.is_root = 0\n    } else {\n      this.form.parent_id = null\n      this.form.is_root = 1\n    }\n  },\n  methods: {\n    async submitForm() {\n      await this.getValue()\n      const form = { ...this.form }\n      let res\n      if (this.isCreate) {\n        res = await Category.addCategory(form)\n      } else {\n        res = await Category.editCategory(this.categoryId, form)\n      }\n      if (res.code < window.MAX_SUCCESS_CODE) {\n        this.$message.success(`${res.message}`)\n        this.$emit('dialogClose')\n      }\n    },\n    async getValue() {\n      const val = await this.$refs.uploadEle.getValue()\n      if (val && val.length > 0) {\n        this.form.img = val[0].display\n      }\n    },\n    resetForm(formName) {\n      this.$refs[formName].resetFields()\n    },\n    handleClose(done) {\n      done()\n      this.$emit('dialogClose')\n    },\n  },\n}\n</script>\n<style lang=\"scss\" scoped>\n.dialog-title {\n  color: $parent-title-color;\n  font-size: 16px;\n  margin-bottom: 20px;\n}\n</style>\n","import { render } from \"./category-edit.vue?vue&type=template&id=eada8af0&scoped=true\"\nimport script from \"./category-edit.vue?vue&type=script&lang=js\"\nexport * from \"./category-edit.vue?vue&type=script&lang=js\"\n\nimport \"./category-edit.vue?vue&type=style&index=0&id=eada8af0&lang=scss&scoped=true\"\n\nimport exportComponent from \"/Users/zhahn/Documents/Hahn/自考/mall/mall_cms/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-eada8af0\"]])\n\nexport default __exports__","<template>\n  <div class=\"container\">\n    <div class=\"header\">\n      <div class=\"title\">分类列表</div>\n      <el-button\n        style=\"margin-left: 30px;\"\n        @click.prevent=\"handleAdd\"\n        type=\"primary\"\n        plain\n        size=\"medium\"\n        v-permission=\"{ permission: '创建分类', type: 'disabled' }\"\n        >创建分类</el-button\n      >\n    </div>\n    <el-table stripe v-loading=\"loading\" :data=\"tableData\">\n      <el-table-column prop=\"id\" label=\"id\" width=\"100\"></el-table-column>\n      <el-table-column prop=\"img\" label=\"图片\" width=\"200\">\n        <template #default=\"scope\">\n          <el-image :src=\"scope.row.img\" :preview-src-list=\"imgSrcList\" style=\"max-height: 50px; max-width: 100px;\">\n          </el-image>\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"name\" label=\"名称\" width=\"150\"></el-table-column>\n      <el-table-column prop=\"index\" label=\"排序\" width=\"150\"></el-table-column>\n      <el-table-column prop=\"online\" label=\"状态\" width=\"100\">\n        <template #default=\"scope\">{{ scope.row.online | onlineFormat }}</template>\n      </el-table-column>\n      <el-table-column prop=\"description\" label=\"描述\" min-width=\"200\" :show-overflow-tooltip=\"true\"></el-table-column>\n      <el-table-column fixed=\"right\" width=\"220\" label=\"操作\">\n        <template #default=\"scope\">\n          <el-button @click.prevent=\"handleSubList(scope.row)\" type=\"primary\" plain size=\"mini\">子分类</el-button>\n          <el-button @click.prevent=\"handleEdit(scope.row)\" type=\"primary\" plain size=\"mini\">编辑</el-button>\n          <el-button\n            @click.prevent=\"handleDelete(scope.row)\"\n            type=\"danger\"\n            plain\n            size=\"mini\"\n            v-permission=\"{ permission: '删除分类', type: 'disabled' }\"\n            >删除</el-button\n          >\n        </template>\n      </el-table-column>\n    </el-table>\n    <div class=\"pagination\">\n      <el-pagination\n        @current-change=\"handleCurrentChange\"\n        :background=\"true\"\n        :page-size=\"pageCount\"\n        :current-page=\"currentPage\"\n        v-if=\"refreshPagination\"\n        layout=\"prev, pager, next, jumper\"\n        :total=\"totalNums\"\n      ></el-pagination>\n    </div>\n    <!--  创建/编辑分类弹窗  -->\n    <div v-if=\"dialogFormVisible\">\n      <el-dialog :append-to-body=\"true\" :before-close=\"handleClose\" :visible.sync=\"visible\" v-model=\"dialogFormVisible\">\n          <category-edit\n          v-if=\"dialogFormVisible\"\n          :isCreate=\"isCreate\"\n          :dialogFormVisible=\"dialogFormVisible\"\n          :categoryId=\"categoryId\"\n          @dialogClose=\"dialogClose\"\n        ></category-edit>\n       </el-dialog>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Category from '@/model/category'\nimport CategoryEdit from './category-edit'\n\nexport default {\n  components: {\n    CategoryEdit,\n  },\n  data() {\n    return {\n      display: true,\n      tableData: [],\n      categoryId: 0,\n      imgSrcList: [], // 用于大图预览\n      totalNums: 0,\n      currentPage: 1,\n      pageCount: 10,\n      refreshPagination: true,\n      dialogFormVisible: false, // 展示弹窗\n      isCreate: false,\n      root: 1, // 是否是父分类,\n      form: {\n        name: '',\n        is_root: 0,\n        parent_id: null,\n        description: '',\n        online: 1,\n        index: null,\n      },\n    }\n  },\n  async created() {\n    this.loading = true\n    this.getCategories()\n    this.loading = false\n  },\n  filters: {\n    onlineFormat(val) {\n      return val === 1 ? '显示' : '不显示'\n    },\n  },\n  watch: {\n    display(val) {\n      this.form.online = val ? 1 : 0\n    },\n  },\n  methods: {\n    async getCategories() {\n      const page = this.currentPage - 1\n      const count = this.pageCount\n      const categories = await Category.getCategories(page, count, this.root)\n      this.tableData = categories.items\n      this.totalNums = categories.total\n      this.initImgSrcList()\n    },\n    // 切换table页\n    async handleCurrentChange(val) {\n      this.imgSrcList = []\n      this.currentPage = val\n      this.loading = true\n      this.getCategories()\n      this.loading = false\n    },\n    initImgSrcList() {\n      this.tableData.forEach(item => {\n        if (!item.img) {\n          return\n        }\n        this.imgSrcList.push(item.img)\n      })\n    },\n    // 获取所拥有的权限并渲染  由子组件提供\n    handleAdd() {\n      this.dialogFormVisible = true\n      this.isCreate = true\n    },\n    handleEdit(val) {\n      this.categoryId = val.id\n      this.isCreate = false\n      this.dialogFormVisible = true\n    },\n    handleDelete(val) {\n      let res\n      this.$confirm('此操作将永久删除该分类，是否继续？', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning',\n      }).then(async () => {\n        try {\n          this.loading = true\n          res = await Category.deleteCategory(val.id)\n        } catch (e) {\n          this.loading = false\n          console.error(e)\n        }\n        if (res.code < window.MAX_SUCCESS_CODE) {\n          this.loading = false\n          if (this.totalNums % this.pageCount === 1 && this.currentPage !== 1) {\n            this.currentPage--\n          }\n          this.getCategories()\n          this.$message({\n            type: 'success',\n            message: `${res.message}`,\n          })\n        } else {\n          this.loading = false\n          this.$message.error(`${res.message}`)\n        }\n      })\n    },\n    handleSubList(row) {\n      this.$router.push({\n        path: `/sub-category/${row.id}/list`,\n        query: { categoryName: row.name },\n      })\n    },\n    dialogClose() {\n      this.dialogFormVisible = false\n      this.loading = true\n      this.getCategories()\n      this.loading = false\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.container {\n  padding: 0 30px;\n\n  .header {\n    display: flex;\n    align-items: center;\n\n    .title {\n      height: 59px;\n      line-height: 59px;\n      color: $parent-title-color;\n      font-size: 16px;\n      font-weight: 500;\n    }\n  }\n\n  .pagination {\n    display: flex;\n    justify-content: flex-end;\n    margin: 20px;\n  }\n}\n</style>\n","import { render } from \"./category-list.vue?vue&type=template&id=61629204&scoped=true\"\nimport script from \"./category-list.vue?vue&type=script&lang=js\"\nexport * from \"./category-list.vue?vue&type=script&lang=js\"\n\nimport \"./category-list.vue?vue&type=style&index=0&id=61629204&lang=scss&scoped=true\"\n\nimport exportComponent from \"/Users/zhahn/Documents/Hahn/自考/mall/mall_cms/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-61629204\"]])\n\nexport default __exports__"],"names":["Category","data","post","res","id","get","put","_delete","page","count","root","style","class","slot","isCreate","model","form","ref","label","prop","size","name","placeholder","index","display","maxNum","value","initData","description","type","rows","submitForm","components","UploadImgs","props","dialogFormVisible","Boolean","default","categoryId","Number","isSub","computed","visible","this","set","is_root","parent_id","online","watch","val","mounted","img","$route","params","methods","getValue","code","window","MAX_SUCCESS_CODE","$message","success","message","$emit","$refs","uploadEle","length","resetForm","formName","resetFields","handleClose","done","__exports__","render","handleAdd","plain","stripe","tableData","width","src","scope","row","imgSrcList","onlineFormat","fixed","handleSubList","handleEdit","handleDelete","loading","refreshPagination","handleCurrentChange","background","pageCount","currentPage","layout","total","totalNums","dialogClose","CategoryEdit","created","getCategories","filters","categories","items","initImgSrcList","forEach","item","push","$confirm","confirmButtonText","cancelButtonText","then","console","error","$router","path","query","categoryName"],"sourceRoot":""}