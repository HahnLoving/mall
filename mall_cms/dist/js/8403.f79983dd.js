"use strict";(self["webpackChunklin_cms_vue"]=self["webpackChunklin_cms_vue"]||[]).push([[8403,9415],{89415:function(e,r,t){t.r(r);var n=t(48534),u=t(13087),o=t(62833),a=(t(35666),t(12109)),i=function(){function e(){(0,u.Z)(this,e)}return(0,o.Z)(e,[{key:"createBook",value:function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,a["default"])({method:"post",url:"v1/book",data:r}));case 1:case"end":return e.stop()}}),e)})));function r(r){return e.apply(this,arguments)}return r}()},{key:"getBook",value:function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(r){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,a.get)("v1/book/".concat(r));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));function r(r){return e.apply(this,arguments)}return r}()},{key:"editBook",value:function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(r,t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,a.put)("v1/book/".concat(r),t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));function r(r,t){return e.apply(this,arguments)}return r}()},{key:"deleteBook",value:function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(r){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,a._delete)("v1/book/".concat(r));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));function r(r){return e.apply(this,arguments)}return r}()},{key:"getBooks",value:function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,a["default"])({method:"get",url:"v1/book",handleError:!0}));case 1:case"end":return e.stop()}}),e)})));function r(){return e.apply(this,arguments)}return r}()}]),e}();r["default"]=new i},48403:function(e,r,t){t.r(r),t.d(r,{default:function(){return C}});var n=t(66252),u=t(56612),o=t(58061),a=function(e){return(0,n.dD)("data-v-154e2900"),e=e(),(0,n.Cn)(),e},i={class:"container"},l={key:0,class:"title"},c={key:1,class:"title"},s=a((function(){return(0,n._)("span",null,"修改图书",-1)})),d=(0,n.Uk)(),f=a((function(){return(0,n._)("i",{class:"iconfont icon-fanhui"},null,-1)})),m=(0,n.Uk)(" 返回 "),p=[f,m],k={class:"wrap"},v=(0,n.Uk)("保 存"),w=(0,n.Uk)("重 置");function b(e,r,t,a,f,m){var b=(0,n.up)("el-input"),h=(0,n.up)("el-form-item"),g=(0,n.up)("el-button"),y=(0,n.up)("el-form"),_=(0,n.up)("el-col"),x=(0,n.up)("el-row");return(0,n.wg)(),(0,n.iD)("div",i,[t.editBookId?((0,n.wg)(),(0,n.iD)("div",c,[s,d,(0,n._)("span",{class:"back",onClick:r[0]||(r[0]=function(){return a.back&&a.back.apply(a,arguments)})},p)])):((0,n.wg)(),(0,n.iD)("div",l,"新建图书"+(0,u.zw)(t.editBookId),1)),(0,n._)("div",k,[(0,n.Wm)(x,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(_,{lg:16,md:20,sm:24,xs:24},{default:(0,n.w5)((function(){return[(0,n.Wm)(y,{model:a.book,"status-icon":"",ref:"form","label-width":"100px",onSubmit:r[5]||(r[5]=(0,o.iM)((function(){}),["prevent"])),rules:a.rules},{default:(0,n.w5)((function(){return[(0,n.Wm)(h,{label:"书名",prop:"title"},{default:(0,n.w5)((function(){return[(0,n.Wm)(b,{modelValue:a.book.title,"onUpdate:modelValue":r[1]||(r[1]=function(e){return a.book.title=e}),placeholder:"请填写书名"},null,8,["modelValue"])]})),_:1}),(0,n.Wm)(h,{label:"作者",prop:"author"},{default:(0,n.w5)((function(){return[(0,n.Wm)(b,{modelValue:a.book.author,"onUpdate:modelValue":r[2]||(r[2]=function(e){return a.book.author=e}),placeholder:"请填写作者"},null,8,["modelValue"])]})),_:1}),(0,n.Wm)(h,{label:"封面",prop:"image"},{default:(0,n.w5)((function(){return[(0,n.Wm)(b,{modelValue:a.book.image,"onUpdate:modelValue":r[3]||(r[3]=function(e){return a.book.image=e}),placeholder:"请填写封面地址"},null,8,["modelValue"])]})),_:1}),(0,n.Wm)(h,{label:"简介",prop:"summary"},{default:(0,n.w5)((function(){return[(0,n.Wm)(b,{type:"textarea",autosize:{minRows:4,maxRows:8},placeholder:"请输入简介",modelValue:a.book.summary,"onUpdate:modelValue":r[4]||(r[4]=function(e){return a.book.summary=e})},null,8,["modelValue"])]})),_:1}),(0,n.Wm)(h,{class:"submit"},{default:(0,n.w5)((function(){return[(0,n.Wm)(g,{type:"primary",onClick:a.submitForm},{default:(0,n.w5)((function(){return[v]})),_:1},8,["onClick"]),(0,n.Wm)(g,{onClick:a.resetForm},{default:(0,n.w5)((function(){return[w]})),_:1},8,["onClick"])]})),_:1})]})),_:1},8,["model","rules"])]})),_:1})]})),_:1})])])}var h=t(48534),g=(t(35666),t(9653),t(41539),t(54747),t(47941),t(62931)),y=t(20610),_=t(89415),x={props:{editBookId:{type:Number,default:null}},setup:function(e,r){var t=(0,g.iH)(null),u=(0,g.iH)(!1),o=(0,g.qj)({title:"",author:"",summary:"",image:""}),a=function(e,r){return Object.keys(e).forEach((function(t){e[t]=r[t]||e[t]}))},i=R(),l=i.rules;(0,n.bv)((function(){e.editBookId&&c()}));var c=function(){var r=(0,h.Z)(regeneratorRuntime.mark((function r(){var t;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return u.value=!0,r.next=3,_["default"].getBook(e.editBookId);case 3:t=r.sent,a(o,t),u.value=!1;case 6:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),s=function(){t.value.resetFields()},d=function(){var n=(0,h.Z)(regeneratorRuntime.mark((function n(u){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.value.validate(function(){var t=(0,h.Z)(regeneratorRuntime.mark((function t(n){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n){t.next=16;break}if(a={},!e.editBookId){t.next=9;break}return t.next=5,_["default"].editBook(e.editBookId,o);case 5:a=t.sent,r.emit("editClose"),t.next=13;break;case 9:return t.next=11,_["default"].createBook(o);case 11:a=t.sent,s(u);case 13:a.code<window.MAX_SUCCESS_CODE&&y.z8.success("".concat(a.message)),t.next=18;break;case 16:console.error("error submit!!"),y.z8.error("请将信息填写完整");case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),f=function(){r.emit("editClose")};return{back:f,book:o,form:t,rules:l,resetForm:s,submitForm:d}}};function R(){var e=function(e,r,t){r||t(new Error("信息不能为空")),t()},r={title:[{validator:e,trigger:"blur",required:!0}],author:[{validator:e,trigger:"blur",required:!0}],summary:[{validator:e,trigger:"blur",required:!0}],image:[{validator:e,trigger:"blur",required:!0}]};return{rules:r}}var B=t(83744);const W=(0,B.Z)(x,[["render",b],["__scopeId","data-v-154e2900"]]);var C=W}}]);
//# sourceMappingURL=8403.f79983dd.js.map