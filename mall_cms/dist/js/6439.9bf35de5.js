"use strict";(self["webpackChunklin_cms_vue"]=self["webpackChunklin_cms_vue"]||[]).push([[6439,370,6260],{95341:function(e,t,n){n.r(t),n.d(t,{default:function(){return S}});var i=n(66252),r=n(58061),a=n(56612),u=function(e){return(0,i.dD)("data-v-6e24dcf9"),e=e(),(0,i.Cn)(),e},o={key:0,class:"container"},s={class:"header"},l=u((function(){return(0,i._)("div",{class:"title"},"SPU列表",-1)})),c=(0,i.Uk)("添加SPU"),d=(0,i.Uk)("编辑"),p=(0,i.Uk)("删除"),g={class:"pagination"};function m(e,t,n,u,m,f){var h=(0,i.up)("el-button"),w=(0,i.up)("el-table-column"),C=(0,i.up)("el-image"),v=(0,i.up)("el-table"),k=(0,i.up)("el-pagination"),S=(0,i.up)("spu-edit"),b=(0,i.Q2)("permission"),_=(0,i.Q2)("loading");return(0,i.wg)(),(0,i.iD)("div",null,[m.showEdit?((0,i.wg)(),(0,i.j4)(S,{key:1,onEditClose:f.editClose,spuId:m.spuId,isCreate:m.isCreate},null,8,["onEditClose","spuId","isCreate"])):((0,i.wg)(),(0,i.iD)("div",o,[(0,i._)("div",s,[l,(0,i.Wm)(h,{style:{"margin-left":"30px"},onClick:(0,r.iM)(f.addSpu,["prevent"]),type:"primary",plain:"",size:"medium"},{default:(0,i.w5)((function(){return[c]})),_:1},8,["onClick"])]),(0,i.wy)((0,i.Wm)(v,{stripe:"",data:m.tableData},{default:(0,i.w5)((function(){return[(0,i.Wm)(w,{fixed:"left",prop:"id",label:"id",width:"100"}),(0,i.Wm)(w,{prop:"img",width:"100",label:"图片"},{default:(0,i.w5)((function(e){return[(0,i.Wm)(C,{src:e.row.img,"preview-src-list":m.imgSrcList,style:{"max-width":"200px"}},null,8,["src","preview-src-list"])]})),_:1}),(0,i.Wm)(w,{"show-overflow-tooltip":!0,prop:"title",label:"标题",width:"200"}),(0,i.Wm)(w,{"show-overflow-tooltip":!0,prop:"subtitle",label:"副标题",width:"250"}),(0,i.Wm)(w,{prop:"category_id",label:"分类id",width:"100"}),(0,i.Wm)(w,{prop:"price",label:"价格(元)",width:"150"}),(0,i.Wm)(w,{prop:"online",label:"是否上架",width:"150"},{default:(0,i.w5)((function(t){return[(0,i.Uk)((0,a.zw)(t.row.online|e.onLine),1)]})),_:1}),(0,i.Wm)(w,{width:"150",fixed:"right",label:"操作"},{default:(0,i.w5)((function(e){return[(0,i.Wm)(h,{onClick:(0,r.iM)((function(t){return f.handleEdit(e.row)}),["prevent"]),type:"primary",plain:"",size:"mini"},{default:(0,i.w5)((function(){return[d]})),_:2},1032,["onClick"]),(0,i.wy)((0,i.Wm)(h,{onClick:(0,r.iM)((function(t){return f.handleDelete(e.row)}),["prevent"]),type:"danger",size:"mini",plain:""},{default:(0,i.w5)((function(){return[p]})),_:2},1032,["onClick"]),[[b,{permission:["删除SPU"],type:"disabled"}]])]})),_:1})]})),_:1},8,["data"]),[[_,e.loading]]),(0,i._)("div",g,[m.refreshPagination?((0,i.wg)(),(0,i.j4)(k,{key:0,onCurrentChange:f.handleCurrentChange,background:!0,"page-size":m.pageCount,"current-page":m.currentPage,layout:"prev, pager, next, jumper",total:m.totalNums},null,8,["onCurrentChange","page-size","current-page","total"])):(0,i.kq)("",!0)])]))])}var f=n(48534),h=(n(41539),n(54747),n(35666),n(48630)),w=n(87838),C={components:{SpuEdit:w["default"]},data:function(){return{spuId:null,isCreate:!1,imgSrcList:[],tableData:[],showEdit:!1,totalNums:0,currentPage:1,pageCount:10,refreshPagination:!0}},created:function(){var e=this;return(0,f.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.loading=!0,e.getSpus(),e.loading=!1;case 3:case"end":return t.stop()}}),t)})))()},methods:{getSpus:function(){var e=this;return(0,f.Z)(regeneratorRuntime.mark((function t(){var n,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.currentPage-1,i=e.pageCount,t.next=4,h["default"].getSpus(n,i);case 4:r=t.sent,e.tableData=r.items,e.totalNums=r.total,e.initImgSrcList();case 8:case"end":return t.stop()}}),t)})))()},initImgSrcList:function(){var e=this;this.tableData.forEach((function(t){t.img&&e.imgSrcList.push(t.img)}))},handleCurrentChange:function(e){var t=this;return(0,f.Z)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.imgSrcList=[],t.currentPage=e,t.loading=!0,t.getSpus(),t.loading=!1;case 5:case"end":return n.stop()}}),n)})))()},handleEdit:function(e){this.isCreate=!1,this.spuId="".concat(e.id),this.showEdit=!0},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((0,f.Z)(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,h["default"].deleteSpu(e.id);case 2:i=n.sent,i.code<window.MAX_SUCCESS_CODE&&(t.getSpus(),t.$message({type:"success",message:"".concat(i.message)}));case 4:case"end":return n.stop()}}),n)}))))},addSpu:function(){this.isCreate=!0,this.spuId=null,this.showEdit=!0},editClose:function(){this.showEdit=!1,this.getSpus()},cellStyleCb:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return"long-text-hidden"}},filters:{onLine:function(e){return 1===e?"是":"否"}}},v=n(83744);const k=(0,v.Z)(C,[["render",m],["__scopeId","data-v-6e24dcf9"]]);var S=k}}]);
//# sourceMappingURL=6439.9bf35de5.js.map